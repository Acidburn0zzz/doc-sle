<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>

<chapter xmlns="http://docbook.org/ns/docbook" 
xmlns:xi="http://www.w3.org/2001/XInclude" 
xmlns:xlink="http://www.w3.org/1999/xlink" 
version="5.0" xml:id="cha-virtualization-scenarios">
<!-- I/O virtualization -->
 <title>Virtualization Scenarios</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker>
   </dm:bugtracker>
  </dm:docmanager>
  <abstract>
   <para>
    Virtualization design provides several useful capabilities to your
    organization: more efficient hardware use, support for legacy software,
    operating system isolation, live migrations, disaster recovery, and 
    load balancing. 
   </para>
  </abstract>
 </info>
 <sect1 xml:id="sec-virtualization-scenarios-capabilities">
  <title>Server Consolidation</title>
  <para>
   Many servers can be replaced by one big physical
   server, so hardware is consolidated, and guest operating systems are
   converted to virtual machines. This also supports running legacy
   software on new hardware.
   <!-- reduce cost -->
  </para>
  <itemizedlist>
    <listitem>
      <para>
       Better usage of resources which were not running at 100%
      </para>
    </listitem>
    <listitem>
      <para>
	Fewer servers locations needed
      </para>
    </listitem>
    <listitem>
      <para>
	Compute resources more efficiently: multiple workloads on the same server
      </para>
    </listitem>
    <listitem>
     <para>
       Simplification of the data center infrastructure
     </para>
   </listitem>
   <listitem>
     <para>
       Moving workload is easier to another host, this will avoid service downtime 
     </para>
   </listitem>
   <listitem>
     <para>
       Virtual Machine provisioning
     </para>
   </listitem>
   <listitem>
     <para>
       Multiple guest operating system will be able to run on 1 host
     </para>
   </listitem>
  </itemizedlist>
  <important>
   <para>The server consolidation scenario needs special attention.</para>
  <itemizedlist>
    <listitem>
     <para>
      Maintenance windows should be carefully planned
     </para>
    </listitem>
    <listitem>
      <para>
	Storage is a key point to be able to support migration and growing disk usage
      </para>
    </listitem>
    <listitem>
      <para>
	Server capabilities must be checked to support the new workload
      </para>
    </listitem>
  </itemizedlist>
  </important>
 </sect1>
 <sect1>
  <title>Isolation</title>
  <para>
   A guest operating system can be fully isolated from the host
   running it. So if the virtual machine is corrupted, the host system is
   not harmed. It also does not affect any other virtual machines. No data
   is shared between VM.
  </para>
  <itemizedlist>
  <listitem>
    <para>
      Secure Boot can be used for VM
     </para>
  </listitem>
  <listitem>
    <para>
     KSM should be avoided
    </para>
  </listitem>
  <listitem>
    <para>
      CPU can be assigned to a VM, and HT should be disabled to avoid security issue
     </para>
  </listitem>
  <listitem>
    <para>
      VM should not share network / storage / network / Hardware
     </para>
  </listitem>
  <listitem>
    <para>
      Migration capabilities could be impacted in case of specific usage like PCI passthrough or NUMA
     </para>
  </listitem>
  <listitem>
    <para>
      Full Virtualization is generally less efficient if no PV/virtio drivers are used
     </para>
  </listitem>
  </itemizedlist>
  <itemizedlist>
   <para>
    AMD provides some specific features regarding Virtualization security.
    <!-- link to the SEV doc? -->
   </para>
   <listitem>
    <para>
     AMD Secure Memory Encryption (SME):
     Uses a single key to encrypt system memory. The key is generated by the AMD Secure Processor at boot. SME requires enablement in the system BIOS or operating system. When enabled in the BIOS, memory encryption is transparent and can be run with any operating system.
    </para>
   </listitem>
   <listitem>
    <para>
     AMD Secure Encrypted Virtualization (SEV):
     Uses one key per virtual machine to isolate guests and the hypervisor from one another. The keys are managed by the AMD Secure Processor. SEV requires enablement in the guest operating system and hypervisor. The guest changes allow the VM to indicate which pages in memory should be encrypted. The hypervisor changes use hardware virtualization instructions and communication with the AMD Secure processor to manage the appropriate keys in the memory controller.
    </para>
   </listitem>
   <listitem>
    <para>
     AMD Secure Encrypted Virtualization-Encrypted State (SEV-ES):
     Encrypts all CPU register contents when a VM stops running. This prevents the leakage of information in CPU registers to components like the hypervisor, and can even detect malicious modifications to a CPU register state.
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
 <!-- MIGRATION IS A VT FEATURE NOT A SCENARIO
 <sect1>
  <title>Migration</title>
  <para>
   Migration is a process to move a running virtual machine to another
   physical machine. Live migration is an extended feature that allows
   this move without disconnection of the client or the application.
  </para>
 </sect1>
 -->
 <sect1>
  <title>Disaster Recovery</title>
  <para>
   <xref linkend="gloss-vt-virtualized"/> guests are less dependent on
   physical hardware. The host server supports making snapshots
   of the virtual machines, enabling restoration to a known good state,
   or to any desired earlier state.
  </para>
 </sect1>
 <sect1>
  <title>Dynamic Load Balancing</title>
  <para>
   A migration feature that provides a simple way to
   load-balance your service across your infrastructure.
  </para>
 </sect1>
</chapter>
