<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect2
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<!-- Converted by suse-upgrade version 1.1 -->
<sect2 xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="sec.update.zypper">
 <title>Distributionsupgrade mit Zypper</title>
 <para>
  Mit dem Kommandozeilentool <command>zypper</command> können Sie die
  Distribution im laufenden Zustand auf der Shell aktualisieren.
 </para>
 <para>
  Dieses Feature richtet sich vor allem an fortgeschrittene Benutzer, die
  Upgrades auf entfernten Rechnern per SSH oder auf mehreren ähnlich
  konfigurierten Systemen gleichzeitig durchführen möchten.
 </para>
 <sect3>
  <title>Vorbereitungen</title>
  <para>
   Bevor Sie das Upgrade mit <command>zypper</command> durchführen, sollten
   Sie ein paar Vorbereitungen treffen, um mögliche Probleme zu vermeiden.
  </para>
  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     Beenden Sie alle nicht benötigten Anwendungen und Dienste. Melden Sie
     außerdem andere Benutzer ab bzw. fordern diese auf, sich auszuloggen.
    </para>
   </listitem>
   <listitem>
    <para>
     Deaktivieren Sie Fremdquellen oder setzen Sie die Priorität dieser
     Drittanbieter-Repositories herab. So stellen Sie sicher, dass Pakete aus
     den Hauptquellen der Distribution den Vorrang haben. Nach dem Upgrade
     können Sie die zusätzlichen Repositories wieder aktivieren und dabei die
     Versionsnummer in der URL der Quelle an die neue Ausgabe der Distribution
     anpassen.
    </para>
   </listitem>
  </itemizedlist>
 </sect3>
 <sect3>
  <title>Der Upgrade-Prozess</title>
  <warning>
   <title>Kontrollieren Sie Ihr Backup</title>
   <para>
    Stellen Sie sicher, dass Sie ein aktuelles Backup Ihres Systems haben und
    dass Sie dieses im Zweifelsfall wiederherstellen können. Das ist
    insbesondere deshalb wichtig, weil Sie viele der folgenden Schritte von
    Hand durchführen werden.
   </para>
  </warning>
  <para>
   Das Programm <command>zypper</command> kennt lange und kurze Aufrufoptionen.
   So können Sie beispielsweise den Befehl <command>zypper install</command>
   zu <command>zypper in</command> verkürzen. Die nächsten Abschnitte
   verwenden die kurze Variante.
  </para>
  <procedure>
   <step>
    <para>
     Führen Sie eine Online-Aktualisierung durch, um alle installierten Pakete
     auf den neuesten Stand zu bringen (siehe
     <xref linkend="cha.onlineupdate.you"/>).
    </para>
   </step>
   <step>
    <para>
     Richten Sie die Repositories ein, die Sie für das folgende Upgrade
     verwenden möchten. Es ist wichtig, dass Sie hier gut aufpassen und keine
     Tippfehler einbauen. Um die Quellen zu konfigurieren, greifen Sie entweder
     zu &yast; (siehe <xref linkend="sec.y2.sw.instsource"/>) oder zu
     <command>zypper</command> (siehe <xref linkend="sec.zypper"/>). Abhängig
     von Ihrem Setup können die Namen in den nächsten Beispielen leicht
     abweichen.
    </para>
    <para>
     Um die aktuell aktivierten Repositories aufzulisten, geben Sie das
     folgende Kommando ein:
    </para>
    <screen>zypper lr -u</screen>
    <para>
     Es ist empfehlenswert sich die Namen aller Repositories zu notieren.
     Nun müssen Sie für jedes der aufgeführten Repositories die alte Version
     (15.1) löschen und eine Kopie für die Version 15.2 erzeugen:
    </para>
    <substeps performance="required">
     <step>
      <para>
       Der Vorgang wird im Folgenden beispielhaft für ein Repository mit
       folgenden Daten durchgeführt.
      </para>
      <simplelist>
       <member>Name: Main Repository (OSS)</member>
       <member>URI: http://download.opensuse.org/distribution/leap/15.1/repo/oss/</member>
      </simplelist>
     </step>
     <step>
      <para>
       Fügen Sie das neue Repository hinzu:
      </para>
      <screen>zypper ar -f \
      http://download.opensuse.org/distribution/leap/15.2/repo/oss/ \
"Main Repository (OSS) 15.2"</screen>

     </step>
     <step>
      <para>
       Löschen Sie das ursprüngliche Repository:
      </para>
      <screen>zypper rr "Main Repository (OSS) 15.1"</screen>
      <para>
       Der hier verwendete Repository-Name (in Anführungszeichen) kann von dem
       auf Ihrem System abweichen. Verwenden Sie den Namen, den Sie sich vorher
       notiert haben.
      </para>
     </step>
     <step>
      <para>
       Schlägt das Hinzufügen des neuen Repositories fehl, prüfen Sie im
       Browser, ob das Repository existiert. Falls nicht, gibt es
       möglicherweise keine neuere Version. In diesem Fall deaktivieren Sie das
       ursprüngliche Repository:
      </para>
      <screen>zypper mr -d <replaceable>NAME</replaceable></screen>
      <para>
       Pakete von deaktivierten Quellen bleiben auf dem System, sofern es kein
       Problem mit Abhängigkeiten zu anderen Komponenten gibt.
      </para>
     </step>
     <step>
      <para>
       Falls Sie weitere Quellen eingerichtet haben, wiederholen Sie diese
       Schritte für alle Repositories, um ein sauberes Upgrade für sämtliche
       Pakete zu garantieren.
      </para>
     </step>
     <step>
      <para>
       Überprüfen Sie noch einmal die aktuelle Konfiguration der
       Paketquellen:
      </para>
<screen>zypper lr -d</screen>
     </step>
    </substeps>
   </step>
   <step>
    <para>
     Aktualisieren Sie die Metadaten auf dem lokalen System und den Inhalt der
     Repositories mit dem Aufruf <command>zypper ref</command>.
    </para>
   </step>
   <step>
    <para>
     Bringen Sie dann zunächst Zypper selbst auf den neuesten Stand von Leap
     15.2; dazu geben Sie <command>zypper up zypper</command> ein.
    </para>
   </step>
   <step>
    <para>
     Anschließend stoßen Sie das Distributions-Upgrade über <command>zypper
     dup</command> an. Abhängig von der Software-Auswahl müssen Sie eine oder
     mehrere Lizenzbestimmungen bestätigen.
    </para>
    <note>
     <title>Ungelöste Abhängigkeiten</title>
     <para>
      Der Befehl <command>zypper dup</command> entfernt alle Pakete, die
      ungelöste Abhängigkeiten aufweisen. Pakete von deaktivierten Quellen
      bleiben auf dem System, sofern es kein Problem mit Abhängigkeiten zu
      anderen Komponenten gibt.
     </para>
     <para>
      <command>zypper dup</command> stellt sicher, dass alle installierten
      Pakete aus einer der verfügbaren Quellen stammen. Das Tool
      berücksichtigt weder die Versionsnummer, noch die Architektur oder den
      Anbieter der installierten Pakete; somit bildet es eine Neuinstallation
      nach. Pakete, die aus den Repositories entfernt wurden, gelten als
      verwaist. Sie werden deinstalliert, falls <command>zypper</command> die
      Abhängigkeiten nicht auflösen kann. Andernfalls verbleiben sie auf dem
      System.
     </para>
    </note>
   </step>
   <step>
    <para>
     Booten Sie den Rechner mit dem Kommando <command>shutdown -r now</command>
     neu.
    </para>
   </step>
  </procedure>
 </sect3>
</sect2>
