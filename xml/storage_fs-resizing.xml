<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd" [
  <!ENTITY % NOVDOC.DEACTIVATE.IDREF "INCLUDE">
  <!ENTITY % entities SYSTEM "entity-decl.ent">
  %entities;
]>
<chapter id="biuymaa" lang="en">
  <title>Resizing File Systems</title>
  <para>
   When your data needs grow for a volume, you might need to increase the
   amount of space allocated to its file system.
  </para>
  <itemizedlist role="subtoc">
   <listitem>
    <para>
     <xref linkend="biuynjy" xrefstyle="SectTitleOnPage"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="biuzt5y" xrefstyle="SectTitleOnPage"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="biuzt64" xrefstyle="SectTitleOnPage"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="biuzt6a" xrefstyle="SectTitleOnPage"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="biuzt6g" xrefstyle="SectTitleOnPage"/>
    </para>
   </listitem>
  </itemizedlist>
  <sect1 id="biuynjy">
   <title>Guidelines for Resizing</title>

   <para>
    Resizing any partition or file system involves some risks that can
    potentially result in losing data.
   </para>

   <warning>
    <para>
     To avoid data loss, ensure that you back up your data before you begin
     any resizing task.
    </para>
   </warning>

   <para>
    Consider the following guidelines when planning to resize a file system.
   </para>

   <itemizedlist role="subtoc">
    <listitem>
     <para>
      <xref linkend="biuytzx" xrefstyle="SectTitleOnPage"/>
     </para>
    </listitem>
    <listitem>
     <para>
      <xref linkend="biuyupz" xrefstyle="SectTitleOnPage"/>
     </para>
    </listitem>
    <listitem>
     <para>
      <xref linkend="biuyw0v" xrefstyle="SectTitleOnPage"/>
     </para>
    </listitem>
   </itemizedlist>

   <sect2 id="biuytzx">
    <title>File Systems that Support Resizing</title>
    <para>
     The file system must support resizing in order to take advantage of
     increases in available space for the volume. In &productname;, file
     system resizing utilities are available for file systems Ext2, Ext3,
     Ext4, and ReiserFS. The utilities support increasing and decreasing the
     size as follows:
    </para>
    <table id="b8qqe0i" frame="topbot" rowsep="1" pgwide="0">
     <title>File System Support for Resizing</title>
     <tgroup cols="4">
      <colspec colnum="1" colname="1" colwidth="2500*"/>
      <colspec colnum="2" colname="2" colwidth="2500*"/>
      <colspec colnum="3" colname="3" colwidth="2500*"/>
      <colspec colnum="4" colname="4" colwidth="2500*"/>
      <thead>
       <row id="b8qqedo">
        <entry>
         <para>
          File System
         </para>
        </entry>
        <entry>
         <para>
          Utility
         </para>
        </entry>
        <entry>
         <para>
          Increase Size (Grow)
         </para>
        </entry>
        <entry>
         <para>
          Decrease Size (Shrink)
         </para>
        </entry>
       </row>
      </thead>
      <tbody>
       <row id="bxuadqe">
        <entry>
         <para>
          Ext2
         </para>
        </entry>
        <entry>
         <para>
          resize2fs
         </para>
        </entry>
        <entry>
         <para>
          Offline only
         </para>
        </entry>
        <entry>
         <para>
          Offline only
         </para>
        </entry>
       </row>
       <row id="bxuadqf">
        <entry>
         <para>
          Ext3
         </para>
        </entry>
        <entry>
         <para>
          resize2fs
         </para>
        </entry>
        <entry>
         <para>
          Online or offline
         </para>
        </entry>
        <entry>
         <para>
          Offline only
         </para>
        </entry>
       </row>
       <row id="bxuacq3">
        <entry>
         <para>
          Ext4
         </para>
        </entry>
        <entry>
         <para>
          resize2fs
         </para>
        </entry>
        <entry>
         <para>
          Offline only
         </para>
        </entry>
        <entry>
         <para>
          Offline only
         </para>
        </entry>
       </row>
       <row id="b8qqedr">
        <entry>
         <para>
          ReiserFS
         </para>
        </entry>
        <entry>
         <para>
          resize_reiserfs
         </para>
        </entry>
        <entry>
         <para>
          Online or offline
         </para>
        </entry>
        <entry>
         <para>
          Offline only
         </para>
        </entry>
       </row>
      </tbody>
     </tgroup>
    </table>
   </sect2>

   <sect2 id="biuyupz">
    <title>Increasing the Size of a File System</title>
    <para>
     You can grow a file system to the maximum space available on the
     device, or specify an exact size. Ensure that you grow the size of the
     device or logical volume before you attempt to increase the size of the
     file system.
    </para>
    <para>
     When specifying an exact size for the file system, ensure that the new
     size satisfies the following conditions:
    </para>
    <itemizedlist>
     <listitem>
      <para>
       The new size must be greater than the size of the existing data;
       otherwise, data loss occurs.
      </para>
     </listitem>
     <listitem>
      <para>
       The new size must be equal to or less than the current device size
       because the file system size cannot extend beyond the space
       available.
      </para>
     </listitem>
    </itemizedlist>
   </sect2>

   <sect2 id="biuyw0v">
    <title>Decreasing the Size of a File System</title>
    <para>
     When decreasing the size of the file system on a device, ensure that
     the new size satisfies the following conditions:
    </para>
    <itemizedlist>
     <listitem>
      <para>
       The new size must be greater than the size of the existing data;
       otherwise, data loss occurs.
      </para>
     </listitem>
     <listitem>
      <para>
       The new size must be equal to or less than the current device size
       because the file system size cannot extend beyond the space
       available.
      </para>
     </listitem>
    </itemizedlist>
    <para>
     If you plan to also decrease the size of the logical volume that holds
     the file system, ensure that you decrease the size of the file system
     before you attempt to decrease the size of the device or logical
     volume.
    </para>
   </sect2>
  </sect1>
  <sect1 id="biuzt5y">
   <title>Increasing the Size of an Ext2, Ext3, or Ext4 File System</title>

   <para>
    The size of Ext2, Ext3, and Ext4 file systems can be increased by using
    the <command>resize2fs</command> command when the file system is
    mounted. The size of an Ext3 file system can also be increased by using
    the <command>resize2fs</command> command when the file system is
    unmounted.
   </para>

   <procedure id="biuzt5z">
    <step id="biuzt60">
     <para>
      Open a terminal console, then log in as the
      <systemitem>root</systemitem> user or equivalent.
     </para>
    </step>
    <step id="bxuagy1">
     <para>
      If the file system is Ext2 or Ext4, you must unmount the file system.
      The Ext3 file system can be mounted or unmounted.
     </para>
    </step>
    <step id="biuzt61">
     <para>
      Increase the size of the file system using one of the following
      methods:
     </para>
     <itemizedlist>
      <listitem>
       <para>
        To extend the file system size to the maximum available size of the
        device called <filename>/dev/sda1</filename>, enter
       </para>
<screen>
resize2fs /dev/sda1
</screen>
       <para>
        If a size parameter is not specified, the size defaults to the size
        of the partition.
       </para>
      </listitem>
      <listitem>
       <para>
        To extend the file system to a specific size, enter
       </para>
<screen>
resize2fs /dev/sda1 <replaceable>size</replaceable>
</screen>
       <para>
        The <replaceable>size</replaceable> parameter specifies the
        requested new size of the file system. If no units are specified,
        the unit of the size parameter is the block size of the file system.
        Optionally, the size parameter can be suffixed by one of the
        following the unit designators: s for 512 byte sectors; K for
        kilobytes (1 kilobyte is 1024 bytes); M for megabytes; or G for
        gigabytes.
       </para>
      </listitem>
     </itemizedlist>
     <para>
      Wait until the resizing is completed before continuing.
     </para>
    </step>
    <step id="biuzt62">
     <para>
      If the file system is not mounted, mount it now.
     </para>
     <para>
      For example, to mount an Ext2 file system for a device named
      <filename>/dev/sda1</filename> at mount point
      <filename>/home</filename>, enter
     </para>
<screen>
mount -t ext2 /dev/sda1 /home
</screen>
    </step>
    <step id="biuzt63">
     <para>
      Check the effect of the resize on the mounted file system by entering
     </para>
<screen>
df -h
</screen>
     <para>
      The Disk Free (<command>df</command>) command shows the total size of
      the disk, the number of blocks used, and the number of blocks
      available on the file system. The -h option print sizes in
      human-readable format, such as 1K, 234M, or 2G.
     </para>
    </step>
   </procedure>
  </sect1>
  <sect1 id="biuzt64">
   <title>Increasing the Size of a Reiser File System</title>

   <para>
    A ReiserFS file system can be increased in size while mounted or
    unmounted.
   </para>

   <procedure id="biuzt65">
    <step id="biuzt66">
     <para>
      Open a terminal console, then log in as the
      <systemitem>root</systemitem> user or equivalent.
     </para>
    </step>
    <step id="biuzt67">
     <para>
      Increase the size of the file system on the device called
      <filename>/dev/sda2</filename>, using one of the following methods:
     </para>
     <itemizedlist>
      <listitem>
       <para>
        To extend the file system size to the maximum available size of the
        device, enter
       </para>
<screen>
resize_reiserfs /dev/sda2
</screen>
       <para>
        When no size is specified, this increases the volume to the full
        size of the partition.
       </para>
      </listitem>
      <listitem>
       <para>
        To extend the file system to a specific size, enter
       </para>
<screen>
resize_reiserfs -s <replaceable>size</replaceable> /dev/sda2
</screen>
       <para>
        Replace <replaceable>size</replaceable> with the desired size in
        bytes. You can also specify units on the value, such as 50000K
        (kilobytes), 250M (megabytes), or 2G (gigabytes). Alternatively, you
        can specify an increase to the current size by prefixing the value
        with a plus (+) sign. For example, the following command increases
        the size of the file system on <filename>/dev/sda2</filename> by 500
        MB:
       </para>
<screen>
resize_reiserfs -s +500M /dev/sda2
</screen>
      </listitem>
     </itemizedlist>
     <para>
      Wait until the resizing is completed before continuing.
     </para>
    </step>
    <step id="biuzt68">
     <para>
      If the file system is not mounted, mount it now.
     </para>
     <para>
      For example, to mount an ReiserFS file system for device
      <filename>/dev/sda2</filename> at mount point
      <filename>/home</filename>, enter
     </para>
<screen>
mount -t reiserfs /dev/sda2 /home
</screen>
    </step>
    <step id="biuzt69">
     <para>
      Check the effect of the resize on the mounted file system by entering
     </para>
<screen>
df -h
</screen>
     <para>
      The Disk Free (<command>df</command>) command shows the total size of
      the disk, the number of blocks used, and the number of blocks
      available on the file system. The -h option print sizes in
      human-readable format, such as 1K, 234M, or 2G.
     </para>
    </step>
   </procedure>
  </sect1>
  <sect1 id="biuzt6a">
   <title>Decreasing the Size of an Ext2 or Ext3 File System</title>

   <para>
    You can shrink the size of the Ext2, Ext3, or Ext4 file systems when the
    volume is unmounted.
   </para>

   <procedure id="biuzt6b">
    <step id="biuzt6c">
     <para>
      Open a terminal console, then log in as the
      <systemitem>root</systemitem> user or equivalent.
     </para>
    </step>
    <step id="bt5yjdr">
     <para>
      Unmount the file system.
     </para>
    </step>
    <step id="biuzt6d">
     <para>
      Decrease the size of the file system on the device such as
      <filename>/dev/sda1</filename> by entering
     </para>
<screen>
resize2fs /dev/sda1 &lt;size&gt;
</screen>
     <para>
      Replace <replaceable>size</replaceable> with an integer value in
      kilobytes for the desired size. (A kilobyte is 1024 bytes.)
     </para>
     <para>
      Wait until the resizing is completed before continuing.
     </para>
    </step>
    <step id="biuzt6e">
     <para>
      Mount the file system. For example, to mount an Ext2 file system for a
      device named <filename>/dev/sda1</filename> at mount point
      <filename>/home</filename>, enter
     </para>
<screen>
mount -t ext2 /dev/md0 /home
</screen>
    </step>
    <step id="biuzt6f">
     <para>
      Check the effect of the resize on the mounted file system by entering
     </para>
<screen>
df -h
</screen>
     <para>
      The Disk Free (<command>df</command>) command shows the total size of
      the disk, the number of blocks used, and the number of blocks
      available on the file system. The -h option print sizes in
      human-readable format, such as 1K, 234M, or 2G.
     </para>
    </step>
   </procedure>
  </sect1>
  <sect1 id="biuzt6g">
   <title>Decreasing the Size of a Reiser File System</title>

   <para>
    Reiser file systems can be reduced in size only if the volume is
    unmounted.
   </para>

   <procedure id="biuzt6h">
    <step id="biuzt6i">
     <para>
      Open a terminal console, then log in as the
      <systemitem>root</systemitem> user or equivalent.
     </para>
    </step>
    <step id="biuzt6j">
     <para>
      Unmount the device by entering
     </para>
<screen>
umount /mnt/point
</screen>
     <para>
      If the partition you are attempting to decrease in size contains
      system files (such as the root (<filename>/</filename>) volume),
      unmounting is possible only when booting from a removable device.
     </para>
    </step>
    <step id="biuzt6k">
     <para>
      Decrease the size of the file system on a device called
      <filename>/dev/sda1</filename> by entering
     </para>
<screen>
resize_reiserfs -s <replaceable>size</replaceable> /dev/sda2
</screen>
     <para>
      Replace <replaceable>size</replaceable> with the desired size in
      bytes. You can also specify units on the value, such as 50000K
      (kilobytes), 250M (megabytes), or 2G (gigabytes). Alternatively, you
      can specify a decrease to the current size by prefixing the value with
      a minus (-) sign. For example, the following command reduces the size
      of the file system on <filename>/dev/md0</filename> by 500 MB:
     </para>
<screen>
resize_reiserfs -s -500M /dev/sda2
</screen>
     <para>
      Wait until the resizing is completed before continuing.
     </para>
    </step>
    <step id="biuzt6l">
     <para>
      Mount the file system by entering
     </para>
<screen>
mount -t reiserfs /dev/sda2 /mnt/point
</screen>
    </step>
    <step id="biuzt6m">
     <para>
      Check the effect of the resize on the mounted file system by entering
     </para>
<screen>
df -h
</screen>
     <para>
      The Disk Free (<command>df</command>) command shows the total size of
      the disk, the number of blocks used, and the number of blocks
      available on the file system. The -h option print sizes in
      human-readable format, such as 1K, 234M, or 2G.
     </para>
    </step>
   </procedure>
  </sect1>
 </chapter>
