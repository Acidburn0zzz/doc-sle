<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd" [
  <!ENTITY % NOVDOC.DEACTIVATE.IDREF "INCLUDE">
  <!ENTITY % entities SYSTEM "entity-decl.ent">
  %entities;
]>
<chapter conformance="sles11,Novell,no,0,80" id="cha_fcoe" lang="en" revision="02/01/12">
  <title>Fibre Channel Storage over Ethernet Networks: FCoE</title>
  <para>
   Many enterprise data centers rely on Ethernet for their LAN and data
   traffic, and on Fibre Channel networks for their storage infrastructure.
   Open Fibre Channel over Ethernet (FCoE) Initiator software allows servers
   with Ethernet adapters to connect to a Fibre Channel storage subsystem
   over an Ethernet network. This connectivity was previously reserved
   exclusively for systems with Fibre Channel adapters over a Fibre Channel
   fabric. The FCoE technology reduces complexity in the data center by
   aiding network convergence. This helps to preserve your existing
   investments in a Fibre Channel storage infrastructure and to simplify
   network management.
  </para>
  <figure pgwide="0" id="bwkfm8v">
   <title>Open Fibre Channel over Ethernet SAN</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="fcoe_san_a.svg" width="445pt" format="SVG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="fcoe_san_a.png" width="445pt" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
  <para>
   Open-FCoE allows you to run the Fibre Channel protocols on the host,
   instead of on proprietary hardware on the host bus adapter. It is
   targeted for 10 Gbps (gigabit per second) Ethernet adapters, but can work
   on any Ethernet adapter that supports pause frames. The initiator
   software provides a Fibre Channel protocol processing module as well as
   an Ethernet based transport module. The Open-FCoE module acts as a
   low-level driver for SCSI. The Open-FCoE transport uses
   <command>net_device</command> to send and receive packets. Data Center
   Bridging (DCB) drivers provide the quality of service for FCoE.
  </para>
  <para>
   FCoE is an encapsulation protocol that moves the Fibre Channel protocol
   traffic over Ethernet connections without changing the Fibre Channel
   frame. This allows your network security and traffic management
   infrastructure to work the same with FCoE as it does with Fibre Channel.
  </para>
  <para>
   You might choose to deploy Open-FCoE in your enterprise if the following
   conditions exist:
  </para>
  <itemizedlist>
   <listitem>
    <para>
     Your enterprise already has a Fibre Channel storage subsystem and
     administrators with Fibre Channel skills and knowledge.
    </para>
   </listitem>
   <listitem>
    <para>
     You are deploying 10 Gbps Ethernet in the network.
    </para>
   </listitem>
  </itemizedlist>
  <para>
   This section describes how to set up FCoE in your network.
  </para>
  <itemizedlist role="subtoc">
   <listitem>
    <para>
     <xref linkend="bxurl07" xrefstyle="SectTitleOnPage"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="bycsjf0" xrefstyle="SectTitleOnPage"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="bxyqov2" xrefstyle="SectTitleOnPage"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="bxuri58" xrefstyle="SectTitleOnPage"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="bxuptlv" xrefstyle="SectTitleOnPage"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="bycscw6" xrefstyle="SectTitleOnPage"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="bycscw7" xrefstyle="SectTitleOnPage"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="bxuqb00" xrefstyle="SectTitleOnPage"/>
    </para>
   </listitem>
  </itemizedlist>
  <sect1 id="bxurl07">
   <title>Installing FCoE and the YaST FCoE Client</title>

   <para>
    You can set up FCoE disks in your storage infrastructure by enabling
    FCoE at the switch for the connections to a server. If FCoE disks are
    available when the SUSE Linux Enterprise Server operating system is
    installed, the FCoE Initiator software is automatically installed at
    that time.
   </para>

   <para>
    If the FCoE Initiator software and YaST FCoE Client software are not
    installed, use the following procedure to manually install them on an
    existing system:
   </para>

   <procedure id="bxurln0">
    <step id="byd2977">
     <para>
      Log in to the server as the <systemitem>root</systemitem> user.
     </para>
    </step>
    <step id="bxurln1">
     <para>
      In YaST, select <guimenu>Software</guimenu><guimenu>Software
      Management</guimenu>.
     </para>
    </step>
    <step id="bxurlrs">
     <para>
      Search for and select the following FCoE packages:
     </para>
     <itemizedlist>
      <listitem>
       <para>
        open-fcoe
       </para>
      </listitem>
      <listitem>
       <para>
        yast2-fcoe-client
       </para>
      </listitem>
     </itemizedlist>
     <para role="intro">
      For example, type <literal>fcoe</literal> in the
      <guimenu>Search</guimenu> field, click <guimenu>Search</guimenu> to
      locate the software packages, then select the check box next to each
      software package that you want to install.
     </para>
     <informalfigure pgwide="0">
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="fcoe_install2_a.png" width="241pt" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="fcoe_install2_a.png" width="241pt" format="PNG"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
    </step>
    <step id="bxurni7">
     <para>
      Click <guimenu>Accept</guimenu>, then click
      <guimenu>Continue</guimenu> to accept the automatic changes.
     </para>
    </step>
   </procedure>
  </sect1>
  <sect1 id="bycsjf0">
   <title>Configuring FCoE Interfaces during the Installation</title>

   <para>
    The YaST installation for SUSE Linux Enterprise Server allows you to
    configure FCoE disks during the operating system installation if FCoE is
    enabled at the switch for the connections between the server and the
    Fibre Channel storage infrastructure. Some system BIOS types can
    automatically detect the FCoE disks, and report the disks to the YaST
    Installation software. However, automatic detection of FCoE disks is not
    supported by all BIOS types. To enable automatic detection in this case,
    you can add the <command>withfcoe</command> option to the kernel command
    line when you begin the installation:
   </para>

<screen>
withfcoe=1
</screen>

   <para role="intro">
    When the FCoE disks are detected, the YaST installation offers the
    option to configure FCoE instances at that time. On the Disk Activation
    page, select <guimenu>Configure FCoE Interfaces</guimenu> to access the
    FCoE configuration. For information about configuring the FCoE
    interfaces, see <xref linkend="bxyqov2" xrefstyle="SectTitleOnPage"/>.
   </para>

   <informalfigure pgwide="0">
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="fcoe_inst_disk_activation_a.png" width="253pt" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="fcoe_inst_disk_activation_a.png" width="253pt" format="PNG"/>
     </imageobject>
    </mediaobject>
   </informalfigure>
  </sect1>
  <sect1 id="bxyqov2">
   <title>Managing FCoE Services with YaST</title>

   <para>
    You can use the YaST FCoE Client Configuration option to create,
    configure, and remove FCoE interfaces for the FCoE disks in your Fibre
    Channel storage infrastructure. To use this option, the FCoE Initiator
    service (the <filename>fcoemon</filename> daemon) and the Link Layer
    Discovery Protocol agent daemon (<command>lldpad</command>) must be
    installed and running, and the FCoE connections must be enabled at the
    FCoE-capable switch.
   </para>

   <procedure id="bxyqpcm">
    <step id="bxyqpcn">
     <para>
      Log in as the <systemitem>root</systemitem> user, then launch YaST.
     </para>
    </step>
    <step id="bxyqpl8">
     <para>
      In YaST, select <guimenu>Network Services</guimenu><guimenu>FCoE
      Client Configuration</guimenu>.
     </para>
     <informalfigure pgwide="0">
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="fcoe_yast2_a.png" width="191pt" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="fcoe_yast2_a.png" width="191pt" format="PNG"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
     <para>
      The Fibre Channel over Ethernet Configuration dialog box provides
      three tabs:
     </para>
     <itemizedlist>
      <listitem>
       <para>
        <guimenu>Services</guimenu>
       </para>
      </listitem>
      <listitem>
       <para>
        <guimenu>Interfaces</guimenu>
       </para>
      </listitem>
      <listitem>
       <para>
        <guimenu>Configuration</guimenu>
       </para>
      </listitem>
     </itemizedlist>
    </step>
    <step id="bycsvr4">
     <para role="intro">
      On the <guimenu>Services</guimenu> tab, view or modify the FCoE
      service and Lldpad (Link Layer Discovery Protocol agent daemon)
      service start time as necessary.
     </para>
     <informalfigure pgwide="0">
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="fcoe_services_a.png" width="201pt" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="fcoe_services_a.png" width="201pt" format="PNG"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
     <itemizedlist>
      <listitem>
       <formalpara id="bycssp2" role="intro">
        <title>FCoE Service Start:</title>
        <para>
         Specifies whether to start the Fibre Channel over Ethernet service
         <command>fcoemon</command> daemon at the server boot time or
         manually. The daemon controls the FCoE interfaces and establishes a
         connection with the <command>lldpad</command> daemon. The values
         are <guimenu>When Booting</guimenu> (default) or
         <guimenu>Manually</guimenu>.
        </para>
       </formalpara>
      </listitem>
      <listitem>
       <formalpara id="bycsvr5" role="intro">
        <title>Lldpad Service Start:</title>
        <para>
         Specifies whether to start the Link Layer Discovery Protocol agent
         <command>lldpad</command> daemon at the server boot time or
         manually. The <command>lldpad</command> daemon informs the
         <command>fcoemon</command> daemon about the Data Center Bridging
         features and the configuration of the FCoE interfaces. The values
         are <guimenu>When Booting</guimenu> (default) or
         <guimenu>Manually</guimenu>.
        </para>
       </formalpara>
      </listitem>
     </itemizedlist>
     <para>
      If you modify a setting, click <guimenu>OK</guimenu> to save and apply
      the change.
     </para>
    </step>
    <step id="bycsxr4">
     <para>
      On the <guimenu>Interfaces</guimenu> tab, view information about all
      of the detected network adapters on the server, including information
      about VLAN and FCoE configuration. You can also create an FCoE VLAN
      interface, change settings for an existing FCoE interface, or remove
      an FCoE interface.
     </para>
     <formalpara id="byct84b" role="intro">
      <title>View FCoE Information</title>
      <para/>
     </formalpara>
     <para role="intro">
      The <guimenu>FCoE Interfaces</guimenu> table displays the following
      information about each adapter:
     </para>
     <informalfigure pgwide="0">
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="fcoe_notconfig_interface_a.png" width="201pt" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="fcoe_notconfig_interface_a.png" width="201pt" format="PNG"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
     <itemizedlist>
      <listitem>
       <formalpara id="byd3h1o" role="intro">
        <title>Device Name:</title>
        <para>
         Specifies the adapter name such as <filename>eth4</filename>.
        </para>
       </formalpara>
      </listitem>
      <listitem>
       <formalpara id="byd3hdt">
        <title>Model:</title>
        <para>
         Specifies the adapter model information.
        </para>
       </formalpara>
      </listitem>
      <listitem>
       <formalpara id="byd3l6i" role="intro">
        <title>FCoE VLAN Interface</title>
        <para/>
       </formalpara>
       <itemizedlist>
        <listitem>
         <formalpara id="byd3nbb">
          <title>Interface Name:</title>
          <para>
           If a name is assigned to the interface, such as
           <filename>eth4.200</filename>, FCoE is available on the switch,
           and the FCoE interface is activated for the adapter.
          </para>
         </formalpara>
        </listitem>
        <listitem>
         <formalpara id="byd3o01">
          <title>Not Configured:</title>
          <para>
           If the status is <guimenu>not configured</guimenu>, FCoE is
           enabled on the switch, but an FCoE interface has not been
           activated for the adapter. Select the adapter, then click
           <guimenu>Create FCoE VLAN Interface</guimenu> to activate the
           interface on the adapter.
          </para>
         </formalpara>
        </listitem>
        <listitem>
         <formalpara id="byd3ohg">
          <title>Not Available:</title>
          <para>
           If the status is <guimenu>not available</guimenu>, FCoE is not
           possible for the adapter because FCoE has not been enabled for
           that connection on the switch.
          </para>
         </formalpara>
        </listitem>
       </itemizedlist>
      </listitem>
      <listitem>
       <formalpara id="byd3mds">
        <title>FCoE Enable:</title>
        <para>
         Specifies whether FCoE is enabled on the switch for the adapter
         connection. (<guimenu>yes</guimenu> or <guimenu>no</guimenu>)
        </para>
       </formalpara>
      </listitem>
      <listitem>
       <formalpara id="byd3pvk">
        <title>DCB Required:</title>
        <para>
         Specifies whether the adapter requires Data Center Bridging.
         (<guimenu>yes</guimenu> or <guimenu>no</guimenu>)
        </para>
       </formalpara>
      </listitem>
      <listitem>
       <formalpara id="byd3qba">
        <title>Auto VLAN:</title>
        <para>
         Specifies whether automatic VLAN configuration is enabled for the
         adapter. (<guimenu>yes</guimenu> or <guimenu>no</guimenu>)
        </para>
       </formalpara>
      </listitem>
      <listitem>
       <formalpara id="byd3r0o">
        <title>DCB Capable:</title>
        <para>
         Specifies whether the adapter supports Data Center Bridging.
         (<guimenu>yes</guimenu> or <guimenu>no</guimenu>)
        </para>
       </formalpara>
      </listitem>
     </itemizedlist>
     <formalpara id="byct8zr" role="intro">
      <title>Change FCoE Settings</title>
      <para/>
     </formalpara>
     <para role="intro">
      Select an FCoE VLAN interface, then click <guimenu>Change
      Settings</guimenu> at the bottom of the page to open the Change FCoE
      Settings dialog box.
     </para>
     <informalfigure pgwide="0">
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="fcoe_modify_config_a.png" width="201pt" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="fcoe_modify_config_a.png" width="201pt" format="PNG"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
     <itemizedlist>
      <listitem>
       <formalpara id="byctmy6">
        <title>FCoE Enable:</title>
        <para>
         Enable or disable the creation of FCoE instances for the adapter.
         Values are <guimenu>yes</guimenu> or <guimenu>no</guimenu>.
        </para>
       </formalpara>
      </listitem>
      <listitem>
       <formalpara id="byctn94">
        <title>DCB Required:</title>
        <para>
         Specifies whether Data Center Bridging is required for the adapter.
         Values are <guimenu>yes</guimenu> (default) or
         <guimenu>no</guimenu>. DCB is usually required.
        </para>
       </formalpara>
      </listitem>
      <listitem>
       <formalpara id="byctn95">
        <title>Auto VLAN:</title>
        <para>
         Specifies whether the <filename>fcoemon</filename> daemon creates
         the VLAN interfaces automatically. Values are
         <guimenu>yes</guimenu> or <guimenu>no</guimenu>.
        </para>
       </formalpara>
      </listitem>
     </itemizedlist>
     <para>
      If you modify a setting, click <guimenu>Next</guimenu> to save and
      apply the change. The settings are written to the
      <filename>/etc/fcoe/eth<replaceable>X</replaceable></filename> file.
      The <command>fcoemon</command> daemon reads the configuration files
      for each FCoE interface when the daemon is initialized. There is a
      file for every FCoE interface.
     </para>
     <formalpara id="byctarx" role="intro">
      <title>Create FCoE VLAN Interfaces</title>
      <para/>
     </formalpara>
     <para role="intro">
      Select an adapter that has FCoE enabled but is not configured, then
      click <guimenu>Yes</guimenu> to configure the FCoE interface. The
      assigned interface name appears in the list, such as
      <filename>eth5.200</filename>.
     </para>
     <informalfigure pgwide="0">
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="fcoe_create_interface_a.png" width="201pt" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="fcoe_create_interface_a.png" width="201pt" format="PNG"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
     <formalpara id="byct8zs" role="intro">
      <title>Remove FCoE Interface</title>
      <para/>
     </formalpara>
     <para role="intro">
      Select the FCoE interface that you want to remove, click
      <guimenu>Remove Interface</guimenu> at the bottom of the page, then
      click <guimenu>Continue</guimenu> to confirm. The FCoE Interface value
      changes to <guimenu>not configured</guimenu>.
     </para>
     <informalfigure pgwide="0">
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="fcoe_remove_interface_a.png" width="201pt" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="fcoe_remove_interface_a.png" width="201pt" format="PNG"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
    </step>
    <step id="bxyqqb9">
     <para role="intro">
      On the <guimenu>Configuration</guimenu> tab, view or modify the
      general settings for the FCoE system service.
     </para>
     <informalfigure pgwide="0">
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="fcoe_configtab_a.png" width="201pt" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="fcoe_configtab_a.png" width="201pt" format="PNG"/>
       </imageobject>
      </mediaobject>
     </informalfigure>
     <itemizedlist>
      <listitem>
       <formalpara id="bycsz4d" role="intro">
        <title>Debug:</title>
        <para>
         Enables or disables debugging messages from the FCoE service script
         and <command>fcoemon</command> daemon. The values are
         <guimenu>Yes</guimenu> or <guimenu>No</guimenu> (default).
        </para>
       </formalpara>
      </listitem>
      <listitem>
       <formalpara id="bycsz4e" role="intro">
        <title>Use syslog:</title>
        <para>
         Specifies whether messages are sent to the system log
         (<filename>/var/log/syslog</filename>). The values are
         <guimenu>Yes</guimenu> (default) or <guimenu>No</guimenu>.
        </para>
       </formalpara>
      </listitem>
     </itemizedlist>
     <para>
      If you modify a setting, click <guimenu>OK</guimenu> to save and apply
      the change. The settings are written to the
      <filename>/etc/fcoe/config</filename> file.
     </para>
    </step>
    <step id="bxyqr8g">
     <para>
      Click <guimenu>OK</guimenu> to save and apply changes.
     </para>
    </step>
   </procedure>
  </sect1>
  <sect1 id="bxuri58">
   <title>Configuring FCoE with Commands</title>

   <procedure id="bxupm0j">
    <step id="bxupo5v">
     <para>
      Log in to the server as the <systemitem>root</systemitem> user, then
      open a terminal console.
     </para>
    </step>
    <step id="bxupmnl">
     <para>
      Use YaST to configure the Ethernet network interface card, such as
      <filename>eth2</filename>.
     </para>
    </step>
    <step id="bxuslhx">
     <para>
      Start the Link Layer Discovery Protocol agent daemon
      (<command>lldpad</command>).
     </para>
<screen>
rclldpad start
</screen>
    </step>
    <step id="bxupmpk">
     <para role="intro">
      Enable Data Center Bridging on your Ethernet adapter<filename/>.
     </para>
<screen>
dcbtool sc eth2 dcb on
  Version:       2
  Command:       Set Config
  Feature:       DCB State
  Port:          eth2
  Status:        Successful
</screen>
    </step>
    <step id="bynkhpe">
     <para>
      Enable and set the Priority Flow Control (PFC) settings for Data
      Center Bridging.
     </para>
<screen>
dcbtool sc eth&lt;x&gt; pfc e:1 a:1 w:1
</screen>
     <para>
      Argument setting values are:
     </para>
     <variablelist>
      <varlistentry id="bynkj1s">
       <term>e:&lt;0|1&gt;</term>
       <listitem>
        <para>
         Controls feature enable.
        </para>
       </listitem>
      </varlistentry>
      <varlistentry id="bynkjej">
       <term>a:&lt;0|1&gt;</term>
       <listitem>
        <para>
         Controls whether the feature is advertised via Data Center Bridging
         Exchange protocol to the peer.
        </para>
       </listitem>
      </varlistentry>
      <varlistentry id="bynkjy8">
       <term>w:&lt;0|1&gt;</term>
       <listitem>
        <para>
         Controls whether the feature is willing to change its operational
         configuration based on what is received from the peer.
        </para>
       </listitem>
      </varlistentry>
     </variablelist>
    </step>
    <step id="bxuppth">
     <para>
      Enable the Data Center Bridging to accept the switch’s priority
      setting for FCoE.
     </para>
<screen>
dcbtool sc eth2 app:fcoe e:1
  Version:       2
  Command:       Set Config
  Feature:       Application FCoE
  Port:          eth2
  Status:        Successful
</screen>
    </step>
    <step id="bxupsun">
     <para>
      Copy the default FCoE configuration file to
      <filename>/etc/fcoe/cfg-eth2</filename>.
     </para>
<screen>
cp /etc/fcoe/cfg-ethx /etc/fcoe/cfg-eth2

</screen>
    </step>
    <step id="bxupsnh">
     <para>
      Start the FCoE Initiator service.
     </para>
<screen>
rcfcoe start
  Starting FCoE initiator service
</screen>
    </step>
    <step id="bxuslzn">
     <para>
      Set up the Link Layer Discovery Protocol agent daemon
      (<command>lldpad</command>) and the FCoE Initiator service to start
      when booting.
     </para>
<screen>systemctl enable llpad.service fcoe.service</screen>
<!--taroth 2014-03-19: systemd - according to fcrozat, no more boot.* stuff:<screen>
chkconfig boot.lldpad on

chkconfig boot.fcoe on
</screen>-->
    </step>
   </procedure>
  </sect1>
  <sect1 id="bxuptlv">
   <title>Managing FCoE Instances with the FCoE Administration Tool</title>

   <para>
    The <command>fcoeadm</command> utility is the Fibre Channel over
    Ethernet (FCoE) management tool for the Open-FCoE project. It can be
    used to create, destroy, and reset an FCoE instance on a given network
    interface. The <command>fcoeadm</command> utility sends commands to a
    running <command>fcoemon</command> process via a socket interface. For
    information about <command>fcoemon</command>, see the
    <command>fcoemon(8)</command> man page.
   </para>

   <para>
    The <command>fcoeadm</command> utility allows you to query the FCoE
    instances about the following:
   </para>

   <itemizedlist>
    <listitem>
     <para>
      Interfaces
     </para>
    </listitem>
    <listitem>
     <para>
      Target LUNs
     </para>
    </listitem>
    <listitem>
     <para>
      Port statistics
     </para>
    </listitem>
   </itemizedlist>

   <para>
    The <command>fcoeadm</command> utility is part of the
    <filename>fcoe-utils</filename> package. It is maintained by the
    <ulink url="http://open-fcoe.org/">Open-FCoE project</ulink>.
   </para>

   <variablelist>
    <varlistentry id="bxuq220">
     <term>Syntax</term>
     <listitem>
      <para>
       Fiber Channel over Ethernet Administration version 1.0.12.
      </para>
<screen>
fcoeadm
  [-c|--create] [&lt;ethX&gt;]
  [-d|--destroy] [&lt;ethX&gt;]
  [-r|--reset] [&lt;ethX&gt;]
  [-S|--Scan] [&lt;ethX&gt;]
  [-i|--interface] [&lt;ethX&gt;]
  [-t|--target] [&lt;ethX&gt;]
  [-l|--lun] [&lt;ethX&gt;]
  [-s|--stats &lt;ethX&gt;] [&lt;interval&gt;]
  [-v|--version]
  [-h|--help]
</screen>
     </listitem>
    </varlistentry>
    <varlistentry id="bxus2zv">
     <term>Options</term>
     <listitem>
      <variablelist>
       <varlistentry id="bxus360">
        <term><literal>-c</literal>
        </term>
        <term><literal>--create &lt;eth<replaceable>X&gt;</replaceable></literal>
        </term>
        <listitem>
         <para>
          Creates an FCoE instance based on the specified network interface.
          If an <command>fcoemon</command> configuration file does not exist
          for the Open-FCoE service daemon interface
          (<filename>/etc/fcoe/cfg-ethx</filename>; see
          <command>fcoemon(8)</command> man page), the created FCoE instance
          does not require Data Center Bridging.
         </para>
         <formalpara id="bycrwhb">
          <title>Example:</title>
          <para>
           To create an FCoE instance on <filename>eth2.101</filename>:
          </para>
         </formalpara>
<screen>
fcoeadm -c eth2.101
</screen>
        </listitem>
       </varlistentry>
       <varlistentry id="bxus6nh">
        <term><literal>-d</literal>
        </term>
        <term><literal>--destroy &lt;eth<replaceable>X&gt;</replaceable></literal>
        </term>
        <listitem>
         <para>
          Destroys an FCoE instance on the specified network interface. This
          does not destroy FCoE instances created by
          <command>fipvlan</command>.
         </para>
         <formalpara id="bycrz5k">
          <title>Example:</title>
          <para>
           To destroy an FCoE instance on <filename>eth2.101</filename>:
          </para>
         </formalpara>
<screen>
fcoeadm -d eth2.101
</screen>
        </listitem>
       </varlistentry>
       <varlistentry id="bxusdp0">
        <term><literal>-h</literal>
        </term>
        <term><literal>--help</literal>
        </term>
        <listitem>
         <para>
          Displays the usage message of the <command>fcoeadm</command>
          command.
         </para>
        </listitem>
       </varlistentry>
       <varlistentry id="bxusaym">
        <term><literal>-i</literal>
        </term>
        <term><literal>--interface [&lt;eth<replaceable>X&gt;</replaceable>]</literal>
        </term>
        <listitem>
         <para>
          Shows information about the FCoE instance on the specified network
          interface. If no network interface is specified, it shows
          information for all FCoE instances.
         </para>
         <formalpara id="bycrz5l">
          <title>Examples</title>
          <para/>
         </formalpara>
         <para>
          To show information about all of the adapters and their ports that
          have FCoE instances created:
         </para>
<screen>
fcoeadm -i
</screen>
         <para>
          To show information about all of the FCoE instances on interface
          <filename>eth3</filename>:
         </para>
<screen>
fcoeadm -i eth3
</screen>
        </listitem>
       </varlistentry>
       <varlistentry id="bxusayp">
        <term><literal>-l</literal>
        </term>
        <term><literal>--lun [&lt;eth<replaceable>X&gt;</replaceable>]</literal>
        </term>
        <listitem>
         <para>
          Shows detailed information about the discovered SCSI LUNs
          associated with the FCoE instance on the specified network
          interface. If no network interface is specified, it shows
          information about SCSI LUNs from all FCoE instances.
         </para>
         <formalpara id="bycs78a" role="intro">
          <title>Examples</title>
          <para/>
         </formalpara>
         <para role="intro">
          To show detailed information about all of the LUNs discovered on
          all FCoE connections:
         </para>
<screen>
fcoeadm -l
</screen>
         <para>
          To show detailed information about all of the LUNs discovered on a
          specific connections, such as <filename>eth3.101</filename>:
         </para>
<screen>
fcoeadm -l eth3.101
</screen>
        </listitem>
       </varlistentry>
       <varlistentry id="bxus75n">
        <term><literal>-r</literal>
        </term>
        <term><literal>--reset &lt;eth<replaceable>X&gt;</replaceable></literal>
        </term>
        <listitem>
         <para>
          Resets the FCoE instance on the specified network interface. This
          does not reset FCoE instances created by
          <command>fipvlan</command>.
         </para>
         <formalpara id="bycrz5m">
          <title>Example:</title>
          <para>
           To reset the FCoE instance on <filename>eth2.101</filename>:
          </para>
         </formalpara>
<screen>
fcoeadm -r eth2.101
</screen>
        </listitem>
       </varlistentry>
       <varlistentry id="bxuscy5">
        <term><literal>-s</literal>
        </term>
        <term><literal>--stats &lt;eth<replaceable>X</replaceable>&gt; [interval]</literal>
        </term>
        <listitem>
         <para>
          Shows the statistics (including FC4 statistics) of the FCoE
          instance on the specified network interface. It displays one line
          per given time interval. Specify the interval value in whole
          integers greater than 0. The interval value is the elapsed time of
          the interval in seconds. If an interval is not specified, the
          default interval is 1 second.
         </para>
         <formalpara id="bycs78b">
          <title>Examples:</title>
          <para/>
         </formalpara>
         <para>
          You can show statistics information about a specific
          <filename>eth3</filename> port that has FCoE instances. The
          statistics are displayed one line per time interval. The default
          interval of one second is not specified in the command.
         </para>
<screen>
fcoeadm -s eth3
</screen>
         <para>
          To show statistics information about a specific
          <filename>eth3</filename> port that has FCoE instances, at an
          interval of 3 seconds. The statistics are displayed one line per
          time interval.
         </para>
<screen>
fcoeadm -s eth3 3
</screen>
        </listitem>
       </varlistentry>
       <varlistentry id="bxusayn">
        <term><literal>-S</literal>
        </term>
        <term><literal>--Scan &lt;eth<replaceable>X&gt;</replaceable></literal>
        </term>
        <listitem>
         <para>
          Rescans for new targets and LUN for the specified network
          interface. This does not rescan any NPIV (N_Port ID
          Virtualization) instances created on the same port, and does not
          rescan any FCoE instances created by <command>fipvlan</command>.
         </para>
        </listitem>
       </varlistentry>
       <varlistentry id="bxusayo">
        <term><literal>-t</literal>
        </term>
        <term><literal>--target [&lt;eth<replaceable>X&gt;</replaceable>]</literal>
        </term>
        <listitem>
         <para>
          Shows information about the discovered targets associated with the
          FCoE instance on the specified network interface. If no network
          interface is specified, it shows information about discovered
          targets from all FCoE instances.
         </para>
         <formalpara id="bycs3pt">
          <title>Examples</title>
          <para/>
         </formalpara>
         <para>
          You can show information about all of the discovered targets from
          all of the ports that have FCoE instances. They might be on
          different adapter cards. After each discovered target, any
          associated LUNs are listed.
         </para>
<screen>
fcoeadm -t
</screen>
         <para>
          You can show information about all of the discovered targets from
          a given <filename>eth3</filename> port having FCoE instance. After
          each discovered target, any associated LUNs are listed.
         </para>
<screen>
fcoeadm -t eth3
</screen>
        </listitem>
       </varlistentry>
       <varlistentry id="bxusdp1">
        <term><literal>-v</literal>
        </term>
        <term><literal>--version</literal>
        </term>
        <listitem>
         <para>
          Displays the version of the <command>fcoeadm</command> command.
         </para>
        </listitem>
       </varlistentry>
      </variablelist>
     </listitem>
    </varlistentry>
    <varlistentry id="bxupx3p">
     <term>FCoE Response Examples</term>
     <listitem>
      <variablelist>
       <varlistentry id="bxupyie">
        <term>View FCoE Initiator Status for FC-ID Node/Port Number</term>
        <listitem>
<screen>
fcoeadm -i eth0.201
  Description:      82599EB 10-Gigabit SFI/SFP+ Network Connection 
  Revision:         01
  Manufacturer:     Intel Corporation 
  Serial Number:    001B219B258C 
  Driver:           ixgbe 3.3.8-k2 
  Number of Ports:  1      

      Symbolic Name:     fcoe v0.1 over eth0.201     
      OS Device Name:    host8     
      Node Name:         0x1000001B219B258E     
      Port Name:         0x2000001B219B258E     
      FabricName:        0x2001000573D38141     
      Speed:             10 Gbit     
      Supported Speed:   10 Gbit     
      MaxFrameSize:      2112     
      FC-ID (Port ID):   0x790003     
      State:             Online
</screen>
        </listitem>
       </varlistentry>
       <varlistentry id="bxuq45l">
        <term>View FCoE Targets for FC-ID Node/Port Number</term>
        <listitem>
<screen>
fcoeadm -t eth0.201  
  Interface:        eth0.201 
  Roles:            FCP Target 
  Node Name:        0x200000D0231B5C72 
  Port Name:        0x210000D0231B5C72 
  Target ID:        0 
  MaxFrameSize:     2048 
  OS Device Name:   rport-8:0-7 
  FC-ID (Port ID):  0x79000C 
  State:            Online  

LUN ID  Device Name   Capacity   Block Size  Description 
------  -----------  ----------  ----------  ----------------------------     
    40  /dev/sdqi     792.84 GB      512     IFT DS S24F-R2840-4 (rev 386C)
    72  /dev/sdpk     650.00 GB      512     IFT DS S24F-R2840-4 (rev 386C)
   168  /dev/sdgy       1.30 TB      512     IFT DS S24F-R2840-4 (rev 386C)
</screen>
        </listitem>
       </varlistentry>
      </variablelist>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect1>
  <sect1 id="bycscw6">
   <title>Setting Up Partitions for an FCoE Initiator Disk</title>

   <para role="intro">
    You can use the <command>fdisk(8)</command> command to set up partitions
    for an FCoE initiator disk.
   </para>

<screen>
fdisk /dev/sdc
  Device contains neither a valid DOS partition table, nor Sun, SGI or OSF disklabel.
  Building a new DOS disklabel with disk identifier 0xfc691889.
  Changes will remain in memory only, until you decide to write them.
  After that, of course, the previous content won’t be recoverable.

  Warning: Invalid flag 0x0000 of partition table 4 will be corrected by w(rite)

  Command (n for help): n
  Command action
     e    extended
     p    primary partition (1-4)

  p
     Partition number (1-4): 4
     First cylinder (1-1017, default 1): 
       Using default value 1
     Last cylinder, *cylinders or *size(K,M,G) (1-1017, default 1017):
       Using default value 1017

  Command (n for help): w
     The partition table has been altered!

     Calling loctl() to re-read partition table.
     Syncing disks.
</screen>
  </sect1>
  <sect1 id="bycscw7">
   <title>Creating a File System on an FCoE Initiator Disk</title>

   <para>
    You can use the <command>mkfs(8)</command> command to create a file
    system on an FCoE initiator disk.
   </para>

<screen>
mkfs /dev/sdc
  mke2fs 1.41.9 (22-Aug-2011)
  /dev/sdc is entire device, not just one partition!
  Proceed anyway? (y, n) y
  Filesystem label=
  OS type: Linux
  Block size=4096 (log-2)
  262144 inodes, 1048576 blocks
  52428 blocks (5.00%) reserved for the super user
  First data block=0
  Maximum filesystem blocks=1073741824
  32 block groups
  32768 blocks per group, 32768 fragments per group
  8192 inodes per group
  Superblock backups stored on blocks:
          32768, 98304, 163840, 229376, 294912, 819200, 804736

  Writing inode tables: done
  Writing superblocks and filesystem accounting information: done

  This filesystem will be automatically checked every 27 mounts or
  180 days, whichever comes first. Use tune2fs -c or -i to override.
</screen>
  </sect1>
  <sect1 id="bxuqb00">
   <title>Additional Information</title>

   <para>
    For information, see the follow documentation:
   </para>

   <itemizedlist>
    <listitem>
     <para>
      For information about the Open-FCoE service daemon, see the
      <command>fcoemon(8)</command>man page.
     </para>
    </listitem>
    <listitem>
     <para>
      For information about the Open-FCoE Administration tool, see the
      <command>fcoeadm(8)</command> man page.
     </para>
    </listitem>
    <listitem>
     <para>
      For information about the Data Center Bridging Configuration tool, see
      the <command>dcbtool(8)</command> man page.
     </para>
    </listitem>
    <listitem>
     <para>
      For information about the Link Layer Discovery Protocol agent daemon,
      see the <filename>lldpad(8)</filename> man page.
     </para>
    </listitem>
    <listitem>
     <para>
      <ulink url="http://www.open-fcoe.org/open-fcoe/wiki/quickstart"><citetitle>Open
      Fibre Channel over Ethernet Quick Start</citetitle></ulink>.
     </para>
    </listitem>
   </itemizedlist>
  </sect1>
 </chapter>
