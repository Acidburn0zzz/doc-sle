<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd"
[
  <!ENTITY % NOVDOC.DEACTIVATE.IDREF "INCLUDE">
  <!ENTITY % entities SYSTEM "entity-decl.ent">
  %entities;
]>
<sect1 id="sec.x11.fontsys">
  <title>Installing and Configuring Fonts</title>
  <indexterm>
    <primary>X</primary>
    <secondary>TrueType fonts</secondary>
  </indexterm>
  <indexterm>
    <primary>fonts</primary>
    <secondary>TrueType</secondary>
  </indexterm>
  <indexterm>
    <primary>X</primary>
    <secondary>fonts</secondary>
  </indexterm>
  <indexterm>
    <primary>X</primary>
    <secondary>xft</secondary>
  </indexterm>
  <indexterm>
    <primary>X</primary>
    <secondary>character sets</secondary>
  </indexterm>

  <para>
    Font appearance can be influenced by two main aspects:
  </para>
  <itemizedlist>
    <listitem>
      <para>
        choosing suitable font family,
      </para>
    </listitem>
    <listitem>
      <para>
        render it with an algorithm, which achieves results comfortable
        for receiver's eyes. 
      </para>
    </listitem>
  </itemizedlist>   
  <para>
    Although above two points are highly subjective, we had to create 
    some defaults. At the same time we try to mediate configuration
    extensibility, which modern Linux font rendering system offers.
  </para>

  <para>
    Linux rendering font system consists of several libraries with different
    relations. Basic font rendering library is 
    <ulink url="http://www.freetype.org/">FreeType</ulink>, which converts
    font glyphs of supported formats to bitmap according to given parameters
    (controls which algorithm should be used for rendering).
  </para>

  <para>
    Every program or library, which uses FreeType, should consult 
   <ulink url="http://www.fontconfig.org/">Fontconfig</ulink> library 
   in the manner to gather font configuration from users and administrators
   of the system. That says, when user amends fontconfig setting in 
   some way, he expects this change evinces on whole system, if possible.
  </para>

  <para>
    More sofisticated opentype shaping needed for scripts such as Arabic, Han 
    or Phags-Pa as well as other higher level text processing lies on shoulders 
    of <ulink url="http://www.harfbuzz.org/">Harfbuzz</ulink> or 
    <ulink url="http://www.pango.org/">Pango</ulink>, just to mention some 
    examples.
  </para>

  <sect2 id="sec.x11.fontsys.install">
    <title>Installing Fonts</title>
    <indexterm>
      <primary>X</primary>
      <secondary>install fonts</secondary>
    </indexterm>
    <indexterm>
      <primary>fonts</primary>
      <secondary>install</secondary>
    </indexterm>
    <indexterm>
      <primary>font</primary>
      <secondary>family</secondary>
    </indexterm>
    <indexterm>
      <primary>font</primary>
      <secondary>style</secondary>
    </indexterm>
    <indexterm>
      <primary>font</primary>
      <secondary>repository</secondary>
    </indexterm>
    <indexterm>
      <primary>font information</primary>
      <secondary>fontinfo.opensuse.org</secondary>
    </indexterm>
 
    <para>
     Invoke
    </para>
    <screen>
$ rpm -qa '*fonts*'</screen>
    <para>
      to see which software packages containing fonts are installed. Every font
      package should satisfy that expression given to rpm (you will get of 
      course some false positives like <literal>fonts-config</literal>).
    </para>
    
    <para>
      To make a picture about font families actually provided on your
      system, run
    </para>
    <screen>
$ fc-list ':' family</screen>

    <note>
      <title>Command <command>fc-list</command></title>
      <para>
        <command>fc-list</command> is just a wrapper to Fontconfig library. 
        It is possible to query many interesting informations from Fontconfig
        library &#x2014; or, more precisely, from its cache. See 
        <command>man 1 fc-list</command> for details.
      </para>
    </note>

    <para>
      If you would like to know how given family looks like, either use
      <command>ftview</command> from <literal>ft2demos</literal> software
      package:
    </para>
    <screen>
$ ftview 14 /usr/share/fonts/truetype/FreeMono.ttf</screen>
    <para>
      on installed font or visit 
      <ulink url="http://fontinfo.opensuse.org/">fontinfo.opensuse.org</ulink>.
    </para>

    <para>
      While deciding which font to choose, keep in mind which styles (regular, 
      bold, italic, etc.) you are expecting from that font and which scripts
      (languages) it should support. All these informations can be also found
      on  <ulink url="http://fontinfo.opensuse.org/">fontinfo.opensuse.org</ulink>
      for fonts already packaged for &productname;.
    </para>

    <para>
      When family was finally chosen, then you can use 
      <command>fc-match</command> to ensure that this family is not already
      present on your system:
    </para>
    <screen>
$ fc-match 'Liberation Serif'
LiberationSerif-Regular.ttf: "Liberation Serif" "Regular"</screen>

    <para>
      When family listed by <command>fc-match</command> do not equal to 
      request, desired font family do not exist on your system and
      <emphasis role="italic">substitution</emphasis> happened:
    </para>
    <screen>
$ fc-match 'Foo Family'
DejaVuSans.ttf: "DejaVu Sans" "Book"</screen>

    <note> 
      <para>
        This is very important. Fontconfig 
        <emphasis role="underline">always</emphasis> returns a real family (if 
        at least one installed) according to given request, as far similar as 
        possible. <quote>Similarity</quote> depends on Fontconfig's internal
        metric as well as on user's or administrator's fontconfig setting.
      </para>
    </note>

    <sect3 id="sec.x11.fontsys.install.instructions">
    <title>Installation instructions</title>
    <para>
      Installation of new fonts is very straitforward. There are two major
      possibilities.
    </para>

    <para>
      First, given that font binary such as <filename>*.ttf</filename> or
      <filename>*.otf</filename> should be installed, just copy or symlink
      it (or symlink directory it contains) to some font directory,
      preferably <filename>/usr/share/fonts</filename> for system wide
      installation or <filename>~/.config/fonts</filename> to keep system
      clean. Fontconfig allows you to use another directory too, but
      you need to let fontconfig know by 
      <literal>&lt;dir&gt;</literal> directive, see 
      <xref linkend="sec.x11.fontsys.config.fontconfig"/>.
    </para>

    <para>
      Second, user or administrator can use fonts that we have packaged. 
      Software package name should contain at least part of family name 
      (lowercase) and literal <literal>fonts</literal> or, rarely, 
      <literal>font</literal>. So you can try luck with
    </para>
    <screen>
$ zypper se '<replaceable>family_name</replaceable>*fonts'</screen>
    <para>
      or equivalent steps with YaST package manager.
    </para>

    <para>
      It is also possible to figure out exact name of software package on
      <ulink url="http://fontinfo.opensuse.org/">fontinfo.opensuse.org</ulink>
      in the section <quote>Software Package Information</quote> of 
      appropriate Font Card for given family and style. More over: clicking
      on software package name, user will be taken into 1-click 
      process to install chosen software package immediately (from 
      <literal>M17N:fonts</literal> repository).
    </para>

    <para>
      Alternatively, it is possible to request packaging other freely
      distributable font family.
    </para>

    </sect3>
  </sect2>

  <sect2 id="sec.x11.fontsys.config">
    <title>Configuring Fonts</title>
    <indexterm>
      <primary>font</primary>
      <secondary>configuration</secondary>
    </indexterm>
    <indexterm>
      <primary>font</primary>
      <secondary>rendering algorithms</secondary>
    </indexterm>
    <indexterm>
      <primary>font family</primary>
      <secondary>substitutions</secondary>
    </indexterm>

  <para>
    Administrator have important part done yet, selecting and installing 
    suitable font. Nevertheless, it might happen that he or she will start 
    to dislike how his favourite font is rendered from certain size down.
  </para>

  <para>
    That means several things. First, less than 300dpi rendering medium is
    used, i. e. pixels are not small enough to satisfy users eyes. Average
    monitor has today circa 100 dpi. Also, wrong rendering algorithm was 
    used, at least from this particular user point of view.
  </para>

  <para>
    There are several algorithms out to face low dpi, such as antialiasing 
    smoothing, hinting (fitting to the grid) or subpixel rendering (tripling
    dpi in one direction). These algorithms can also differ from one font
    format to another.
  </para>

  <important>
    <para>
      Subpixel rendering is not used. Although FreeType2 have support for this
      algorithm, it is covered by several patents expiring at the end of
      year 2019. Therefore, setting subpixel rendering options in fontconfig
      has no effect as long as system has FreeType2 library with subpixel
      rendering not compiled in.
    </para>
  </important>

  <para>
    Via fontconfig, it is possible to select rendering algorithms for every
    font individually or for set of fonts.
  </para>

  <para>
    In fontconfig, there is also an option to substitute one family name to
    another trough <emphasis role='italic'>alias</emphasis> mechanism. As
    special example, generic names such as <literal>sans-serif</literal>,
    <literal>serif</literal> or <literal>monospace</literal> can be subsituted
    by real family names or even to preference list of family names. In these
    lists will fontconfig look as soon as request for such generic name is
    permormed:
  </para>
  <screen>
$ fc-match monospace
LiberationMono-Regular.ttf: "Liberation Mono" "Regular"</screen>

  <sect3 id="sec.x11.fontsys.config.sysconfig">
    <title>Configuring Fonts via <literal>sysconfig</literal></title>
    <para>
      &productname; come up with <literal>sysconfig</literal> layer above
      fontconfig XML files with hope it is good starting point for
       experimenting with font configuration. For this purpose, edit
      <filename>/etc/sysconfig/fonts-config</filename>, or use YaST 
      sysconfig module. Then run
    </para>
    <screen>
# /usr/sbin/fonts-config</screen>
    <para>
      as root and rerun the application to take the effect.
    </para>

    <note>
      <itemizedlist>
        <listitem>
          <para>
            Some applications time to time reread font configuration. E. g. newly
            created or reloaded Firefox's tabs might get new font configuration.
          </para>
        </listitem>
        <listitem>
          <para>
            <command>fonts-config</command> script is called after every software
            package installation or removal automatically (if not, it is a bug
            of font software package).
          </para>
        </listitem>
        <listitem>
          <para>
            Every sysconfig variable can be temporarily overriden by 
            <command>fonts-config</command> command line option. See
            <command>fonts-config --help</command> for details.
          </para>
        </listitem>
      </itemizedlist>      
    </note>

    <para>
      For explanation of particular sysconfig variables, see 
      <command>man 1 fonts-config</command> or help of YaST sysconfig module.
      From rendering algorithms usage point of view, consider
      <literal>FORCE_HINTSTYLE</literal>, <literal>FORCE_AUTOHINT</literal>,
      <literal>FORCE_BW</literal>, <literal>FORCE_BW_MONOSPACE</literal>,
      <literal>USE_EMBEDDED_BITMAPS</literal> and 
      <literal>EMBEDDED_BITMAP_LANGAGES</literal>. With 
      <literal>PREFER_SANS_FAMILIES</literal>, 
      <literal>PREFER_SERIF_FAMILIES</literal>,
      <literal>PREFER_MONO_FAMILIES</literal> and
      <literal>SEARCH_METRIC_COMPATIBLE</literal> variables administrator
      can alter preference lists of generic aliases for sans-serif, 
      serif and monospace.
    </para>

    <para>
      At the end of this section, we will provide you by enumeration
      of configuration examples, sorted from <quote>most readable</quote> fonts
      (more contrast) to <quote>most beautiful</quote> fonts (more smoothed).
    </para>

    <example id="ex.x11.fontsys.sysconfig.bitmap">
       <title>Bitmap fonts.</title>
       <para>
         Prefer bitmap fonts via <literal>PREFER_*_FAMILIES</literal>. 
         Just follow relevant example in the help to this variables. System 
         will get fonts rendered black and white, not smoothed. Bitmap fonts
         also provides several sizes only. Consider
       </para>
       <screen>
SEARCH_METRIC_COMPATIBLE="no"</screen> 
       <para>
         to disable metric compatibility driven family name substitutions.
       </para>
    </example>
    <example id="ex.x11.fontsys.sysconfig.bw">
      <title>Scalable fonts rendered black and white.</title>
      <para>
        Scalable fonts rendered without antialiasing can result in similar 
        outcome like bitmap fonts, when rendering well hinted fonts like 
        Liberation families, while maintaining font scalability. There is lack 
        of well hinted fonts though. Set
      </para>
      <screen>
FORCE_BW="yes"</screen>
    </example>
    <example id="ex.x11.fontsys.sysconfig.bw_monospace">
      <title>Monospaced fonts rendered black and white.</title>
      <para>
        Render without antialiasing monospaced fonts only, otherwise use
        Default setting.
      </para>
      <screen>
FORCE_BW_MONOSPACE="yes"</screen>
    </example>
    <example id="ex.x11.fontsys.sysconfig.default">
      <title>Default.</title>
      <para>
        All fonts are rendered with antialiasing, well hinted fonts with byte
        code interpreter (BCI) and with autohinter 
        (with <literal>hintstyle=hintslight</literal>) the rest. Leave all relevant 
        sysconfig in the default setting.
      </para>
    </example>
    <example id="ex.x11.fontsys.sysconfig.cff">
      <title>CFF Fonts.</title>
      <para>
        Use fonts of CFF format. They can be considered also more readable
        than default TrueType fonts
        given current improvements to FreeType2. Try them out by following
        example of <literal>PREFER_*_FAMILIES</literal>. Also consider to use
      </para>
      <screen>
SEARCH_METRIC_COMPATIBLE="no"</screen>
    </example>
    <example id="ex.x11.fontsys.sysconfig.autohint">
      <title>Use autohinter exclusively.</title>
      <para>
         Even for well hinted font, use FreeType2's autohinter. That can lead
         to more thick stems with lower contrast and sometimes to fuzzier 
         results. Set
      </para>
      <screen>
FORCE_AUTOHINTER="yes"</screen>
    </example>
  </sect3>
  
  <sect3 id="sec.x11.fontsys.config.fontconfig">
  <title>Diving into Fontconfig XML</title>
  <para>
    We limit ourselves to few examples instead of complete reference, which
    would be very extensive. Details and other inspiration can be found in
    <command>man 5 fonts-conf</command> or in 
    <filename>/etc/fonts/conf.d/</filename>.
  </para>
    
  <para>
    The starting point of Fontconfig configuration is 
    <filename>/etc/fonts/fonts.conf</filename>, which, along other work,
    includes whole <filename>/etc/fonts/conf.d/</filename> directory.
  </para>

  <note>
    <itemizedlist>
      <listitem>
        <para>
          <filename>/etc/fonts/conf.d/*-local.conf</filename> includes
          <filename>/etc/fonts/local.conf</filename>. Manual system wide
          changes should go into that file.
        </para>
      </listitem>
      <listitem>
        <para>
          <filename>/etc/fonts/conf.d/*-user.conf</filename> includes also
          <filename>~/.config/fontconfig/fonts.conf</filename> file and
          <filename>~/.config/fontconfig/conf.d</filename> directory. User
          specific changes should go there. <filename>~/.fonts.conf</filename>
          and <filename>~/.fonts.conf.d/</filename> are included as well,
          but these locations are deprecated.
        </para>
      </listitem>  
    </itemizedlist>
  </note>

  <para>
    Every fontconfig XML file must start with header
  </para>
  <screen>
&lt;?xml version="1.0"?>
&lt;!DOCTYPE fontconfig SYSTEM "fonts.dtd">
&lt;fontconfig></screen>
  <para>
    and be closed with tailer
  </para>
  <screen>
&lt;/fontconfig></screen>

  <example id="ex.x11.fontsys.fontconfig.dir_directive">
    <title>Defining font directory.</title>
    <para>
       If font files really has to be stored somewhere else than 
       in <filename>/usr/share/fonts</filename> and can't be symlinked
       there, use
    </para>
    <screen>
&lt;dir>/usr/share/fonts2&lt;/dir></screen>
    <para>
       to let fontconfig know. This directory is searched for fonts
       <emphasis role="underline">recursively.</emphasis>
    </para>
  </example>

  <example id="ex.x11.fontsys.fontconfig.rendering_algoritms">
    <title>Specifying endering algorithms.</title>
    <para>
      Font rendering algorithms can be chosen with following-like
      fontconfig snippet:
    </para>
    <screen>
&lt;match target="font">
        &lt;test name="family">
                &lt;string><replaceable>FAMILY_NAME</replaceable>&lt;/string>
        &lt;/test>
        &lt;edit name="antialias" mode="assign">
                &lt;bool>true&lt;/bool>
        &lt;/edit>
        &lt;edit name="hinting" mode="assign">
                &lt;bool>true&lt;/bool>
        &lt;/edit>
        &lt;edit name="autohint" mode="assign">
                &lt;bool>false&lt;/bool>
        &lt;/edit>
        &lt;edit name="hintstyle" mode="assign">
                &lt;const>hintfull&lt;/const>
        &lt;/edit>
&lt;/match></screen>
  </example>

  <para>
    Various properties of fonts can be <literal>&lt;test></literal>ed,
    such as size interval, spacing, font format, languages it supports, 
    etc. When abandoning <literal>&lt;test></literal> completely,
    <literal>&lt;edit></literal>s applies to every font (global change).
  </para>

  <example id="ex.x11.fontsys.fontconfig.aliases1">
    <title>Aliases and family names substitutions.</title>
    <variablelist>
      <varlistentry id="vle.x11.fontsys.example.alias.default">
        <term>rule 1</term>
        <listitem>
          <screen>
&lt;alias>
        &lt;family>Alegreya SC&lt;/family>
        &lt;default>
                &lt;family>serif&lt;/family>
        &lt;/default>
&lt;/alias></screen>
        </listitem>
      </varlistentry>
      <varlistentry id="vle.x11.fontsys.example.alias.prefer">
        <term>rule 2</term>
        <listitem>
          <screen>
&lt;alias>
        &lt;family>serif&lt;/family>
        &lt;prefer>
                &lt;family>Droid Serif&lt;/family>
        &lt;/prefer>
&lt;/alias></screen>
        </listitem>
      </varlistentry>
      <varlistentry id="vle.x11.fontsys.example.alias.accept">
        <term>rule 3</term>
        <listitem>
          <screen>
&lt;alias>
        &lt;family>serif&lt;/family>
        &lt;accept>
                &lt;family>STIXGeneral&lt;/family>
        &lt;/accept>
&lt;/alias></screen>
        </listitem>
      </varlistentry>
    </variablelist>
  </example>

  <para>
    We can think of Fontconfig's alias mechanism like of creating prioritized 
    family list (PFL).
    <literal>&lt;default></literal> alias from 
    <xref linkend="vle.x11.fontsys.example.alias.default"/> will add 
    <literal>serif</literal> family name 
    <emphasis role="bold">at the end</emphasis> of PFL, whenever 
    <literal>Alegreya SC</literal> is present in PFL;
    <literal>&lt;prefer></literal> from 
    <xref linkend="vle.x11.fontsys.example.alias.prefer"/> will add
    <literal>Droid Serif</literal> <emphasis role="bold">
    just before</emphasis> first occurence of <literal>serif</literal> 
    in the PFL; <literal>&lt;accept></literal> in 
    <xref linkend="vle.x11.fontsys.example.alias.accept"/> 
    will add <literal>STIXGeneral</literal> family name 
    <emphasis role="bold">just after</emphasis> first occurence of
    <literal>serif</literal> family name in the PFL.
  </para>
   
  <para>
    Putting this together, when snippets occur in order 
    <xref linkend="vle.x11.fontsys.example.alias.default"/> -
    <xref linkend="vle.x11.fontsys.example.alias.prefer"/> -
    <xref linkend="vle.x11.fontsys.example.alias.accept"/> and user requests
    <literal>Alegreya SC</literal>, then PFL is created as follows:
  </para>

  <table id="tab.x11.fontsys.example.alias">
    <title>Generating PFL from fontconfig rules</title>
    <tgroup cols="2">
      <thead>
        <row>
          <entry><para>Step</para></entry>
          <entry><para>Current PFL</para></entry>
        </row>
      </thead>
      <tbody>
        <row>
          <entry><para>Request</para></entry>
          <entry><para><literal>Alegreya SC</literal></para></entry>
        </row>
        <row>
          <entry><para>
            <xref linkend="vle.x11.fontsys.example.alias.default"/>
          </para></entry>
          <entry><para>
            <literal>Alegreya SC</literal>,
            <literal>serif</literal>
          </para></entry>
        </row>
        <row>
          <entry><para>
            <xref linkend="vle.x11.fontsys.example.alias.prefer"/>
          </para></entry>
          <entry><para>
            <literal>Alegreya SC</literal>,
            <literal>Droid Serif</literal>,
            <literal>serif</literal>
          </para></entry>
        </row>
        <row>
          <entry><para>
            <xref linkend="vle.x11.fontsys.example.alias.accept"/>
          </para></entry>
          <entry><para>
            <literal>Alegreya SC</literal>,
            <literal>Droid Serif</literal>,
            <literal>serif</literal>,
            <literal>STIXGeneral</literal>
          </para></entry>
        </row>
      </tbody>
    </tgroup>
  </table>

  <para>
    In the Fontconfig's metrics, family name has highest priority over other
    pattern entities, like style, size, etc. Fontconfig now checks which 
    family is currently installed on the system. If 
    <literal>Alegreya SC</literal> is installed, then fontconfig returns 
    it. If not, asks for <literal>Droid Serif</literal>, etc.
  </para>

  <para>
    But be careful! When order of fontconfig snippets is changed, system can
    return different results:
  </para>

  <table id="tab.x11.fontsys.example.alias2">
    <title>Generating PFL from fontconfig rules</title>
    <tgroup cols="3">
      <thead>
        <row>
          <entry><para>Step</para></entry>
          <entry><para>Current PFL</para></entry>
          <entry><para>Note</para></entry>
        </row>
      </thead>
      <tbody>
        <row>
          <entry><para>Request</para></entry>
          <entry><para><literal>Alegreya SC</literal></para></entry>
          <entry><para>Same request performed.</para></entry>
        </row>
        <row>
          <entry><para>
            <xref linkend="vle.x11.fontsys.example.alias.prefer"/>
          </para></entry>
          <entry><para>
            <literal>Alegreya SC</literal>
          </para></entry>
          <entry><para>
            <literal>serif</literal> not in FPL, nothing is substituted
          </para></entry>
        </row>
        <row>
          <entry><para>
            <xref linkend="vle.x11.fontsys.example.alias.accept"/>
          </para></entry>
          <entry><para>
            <literal>Alegreya SC</literal>
          </para></entry>
          <entry><para>
            <literal>serif</literal> not in FPL, nothing is substituted
          </para></entry>
        </row>
        <row>
          <entry><para>
            <xref linkend="vle.x11.fontsys.example.alias.default"/>
          </para></entry>
          <entry><para>
            <literal>Alegreya SC</literal>,
            <literal>serif</literal>
          </para></entry>
          <entry><para>
            <literal>Alegreya SC</literal> present in FPL, substitution 
            is performed
          </para></entry>
        </row>
      </tbody>
    </tgroup>
  </table>

  <note>
    <title>Implication.</title>
    <para>
      We can think about <literal>&lt;default></literal> alias like 
      classification or inclusion in the group. Purpose is to have 
      a possibility to substitute one family to another inside this
      group (if not installed). As example shows,
      <literal>&lt;default></literal> should always precede 
      <literal>&lt;prefer></literal> and <literal>&lt;accept></literal>
      aliases of that group.
    </para>

    <para>
      We can also think about fontconfig alias system as of oriented graph.
      <literal>&lt;default></literal> alias creates edges from specific
      families (here <literal>Alegreya SC</literal>) to generic names
      (here <literal>serif</literal>), whereas 
      <literal>&lt;prefer></literal> and <literal>&lt;accept></literal>
      aliases create edges from generics (here <literal>serif</literal>)
      to specifics (here <literal>Droid Serif</literal> and 
      <literal>STIXGeneral</literal>).
    </para>
  </note>

  <example id="ex.x11.fontsys.fontconfig.aliases2">
    <title>Aliases and family names substitutions.</title>
    <para>
      Following fontconfig snippet would lead to complete oriented tree
      with root <literal>serif</literal>. In other words, every family
      in group <literal>serif</literal> could substitute to other in 
      that group, when the former not installed.
    </para>
    <screen>
&lt;alias>
        &lt;family>Alegreya SC&lt;/family>
        &lt;default>
                &lt;family>serif&lt;/family>
        &lt;/default>
&lt;/alias>
&lt;alias>
        &lt;family>Droid Serif&lt;/family>
        &lt;default>
                &lt;family>serif&lt;/family>
        &lt;/default>
&lt;/alias>
&lt;alias>
        &lt;family>STIXGeneral&lt;/family>
        &lt;default>
                &lt;family>serif&lt;/family>
        &lt;/default>
&lt;/alias>
&lt;alias>
        &lt;family>serif&lt;/family>
        &lt;accept>
                &lt;family>Droid Serif&lt;/family>
                &lt;family>STIXGeneral&lt;/family>
                &lt;family>Alegreya SC&lt;/family>
        &lt;/accept>
&lt;/alias></screen>
    <para>
      Priority is given by order in <literal>&lt;accept></literal> alias.
      Similarly, stronger <literal>&lt;prefer></literal> alias can be used.
    </para>
  </example>

  <example id="ex.x11.fontsys.fontconfig.aliases3">
    <title>Aliases and family names substitutions.</title>
    <para>
      When we expand example <xref linkend="ex.x11.fontsys.fontconfig.aliases1"/> by
    </para>

    <variablelist>
      <varlistentry id="vle.x11.fontsys.example.alias.accept2">
        <term>rule 4</term>
        <listitem>
          <screen>
&lt;alias>
        &lt;family>serif&lt;/family>
        &lt;accept>
                &lt;family>Liberation Serif&lt;/family>
        &lt;/accept>
&lt;/alias></screen>
        </listitem>
      </varlistentry>
      <varlistentry id="vle.x11.fontsys.example.alias.prefer2">
        <term>rule 5</term>
        <listitem>
          <screen>
&lt;alias>
        &lt;family>serif&lt;/family>
        &lt;prefer>
                &lt;family>DejaVu Serif&lt;/family>
        &lt;/prefer>
&lt;/alias></screen>
        </listitem>
      </varlistentry>
    </variablelist>
  </example>

  <para>
    This would lead following PFL evolution:
  </para>

  <table id="tab.x11.fontsys.example.alias3">
    <title>Generating PFL from fontconfig rules</title>
    <tgroup cols="2">
      <thead>
        <row>
          <entry><para>Step</para></entry>
          <entry><para>Current PFL</para></entry>
        </row>
      </thead>
      <tbody>
        <row>
          <entry><para>Request</para></entry>
          <entry><para><literal>Alegreya SC</literal></para></entry>
        </row>
        <row>
          <entry><para>
            <xref linkend="vle.x11.fontsys.example.alias.default"/>
          </para></entry>
          <entry><para>
            <literal>Alegreya SC</literal>,
            <literal>serif</literal>
          </para></entry>
        </row>
        <row>
          <entry><para>
            <xref linkend="vle.x11.fontsys.example.alias.prefer"/>
          </para></entry>
          <entry><para>
            <literal>Alegreya SC</literal>,
            <literal>Droid Serif</literal>,
            <literal>serif</literal>
          </para></entry>
        </row>
        <row>
          <entry><para>
            <xref linkend="vle.x11.fontsys.example.alias.accept"/>
          </para></entry>
          <entry><para>
            <literal>Alegreya SC</literal>,
            <literal>Droid Serif</literal>,
            <literal>serif</literal>,
            <literal>STIXGeneral</literal>
          </para></entry>
        </row>
        <row>
          <entry><para>
            <xref linkend="vle.x11.fontsys.example.alias.accept2"/>
          </para></entry>
          <entry><para>
            <literal>Alegreya SC</literal>,
            <literal>Droid Serif</literal>,
            <literal>serif</literal>,
            <literal>Liberation Serif</literal>,
            <literal>STIXGeneral</literal>
          </para></entry>
        </row>
        <row>
          <entry><para>
            <xref linkend="vle.x11.fontsys.example.alias.prefer2"/>
          </para></entry>
          <entry><para>
            <literal>Alegreya SC</literal>,
            <literal>Droid Serif</literal>,
            <literal>DejaVu Serif</literal>,
            <literal>serif</literal>,
            <literal>Liberation Serif</literal>,
            <literal>STIXGeneral</literal>
          </para></entry>
        </row>
      </tbody>
    </tgroup>
  </table>

  <note>
    <title>Implications.</title>
    <itemizedlist>
      <listitem>
        <para>
          Former <literal>&lt;accept></literal> is shadowed by later 
          <literal>&lt;accept></literal> for the same generic name.
          If possible, do not use <literal>&lt;accept></literal>
          <emphasis role="bold">after</emphasis> user 
          (<filename>/etc/fonts/conf.d/*-user.conf</filename>) when
          creating system wide configuration.
        </para>
      </listitem>
      <listitem>
        <para>
          Former <literal>&lt;prefer></literal> shadows later 
          <literal>&lt;prefer></literal> for the same generic name.
          If possible, do not use <literal>&lt;prefer></literal>
          <emphasis role="bold">before</emphasis> user in
          the system wide configuration.
        </para>
      </listitem>
      <listitem>
        <para>
          Every <literal>&lt;prefer></literal> shadows every 
          <literal>&lt;accept></literal> when used for the same generic
          name. If administrator want to leave user free hands to use
          even <literal>&lt;accept></literal>, not only 
          <literal>&lt;prefer></literal>, does not use 
          <literal>&lt;prefer></literal> at all in system wide configuration.
          On the other hand, users use <literal>&lt;prefer></literal> in 
          majority, so that should not harm and we see using 
          <literal>&lt;prefer></literal> also in system wide configuration.
        </para>
      </listitem>
    </itemizedlist>
  </note>

  </sect3>
  </sect2>
</sect1>

