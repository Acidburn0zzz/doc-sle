<?xml version="1.0"?>
<!DOCTYPE chapter PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd"
[
  <!ENTITY % NOVDOC.DEACTIVATE.IDREF "INCLUDE">
  <!ENTITY % entities SYSTEM "entity-decl.ent">
  %entities;
]>
<chapter id="cha.xen.save">
 <title>Save and Restore of Virtual Machines</title>
 <para></para>
 <sect1 id="sec.xen.config.suspend">
  <title>Saving Virtual Machines</title>

  <procedure>
   <title>Save a Virtual Machine’s Current State</title>
   <step>
    <para>
     Make sure the virtual machine to be saved is running.
    </para>
   </step>
   <step>
    <para>
     In the host environment, enter
    </para>
<screen>xl save <replaceable>ID</replaceable> <replaceable>state-file</replaceable></screen>
    <para>
     where <replaceable>ID</replaceable> is the virtual machine ID you want
     to save, and <replaceable>state-file</replaceable> is the name you
     specify for the memory state file. By default, the domain will no
     longer be running after you create its snapshot. Use
     <option>-c</option> to keep it running even after you create the
     snapshot.
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 id="sec.xen.config.restore">
  <title>Restoring Virtual Machines</title>

  <procedure>
   <title>Restore a Virtual Machine’s Current State</title>
   <step>
    <para>
     Make sure the virtual machine to be restored has not been started since
     you ran the save operation.
    </para>
   </step>
   <step>
    <para>
     In the host environment, enter
    </para>
<screen>xl restore <replaceable>state-file</replaceable></screen>
    <para>
     where <replaceable>state-file</replaceable> is the previously saved
     memory state file. By default, the domain will be running after it is
     restored. To pause it after the restore, use <option>-p</option>.
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 id="sec.xen.config.state">
  <title>Virtual Machine States</title>

  <para>
   A virtual machine’s state can be displayed by viewing the results of
   the <command>xm list</command> command, which abbreviates the state using
   a single character.
  </para>

  <itemizedlist>
   <listitem>
    <para>
     <command>r</command> - running - The virtual machine is currently
     running and consuming allocated resources.
    </para>
   </listitem>
   <listitem>
    <para>
     <command>b</command> - blocked - The virtual machine’s processor is
     not running and not able to run. It is either waiting for I/O or has
     stopped working.
    </para>
   </listitem>
   <listitem>
    <para>
     <command>p</command> - paused - The virtual machine is paused. It does
     not interact with the hypervisor but still maintains its allocated
     resources, such as memory.
    </para>
   </listitem>
   <listitem>
    <para>
     <command>s</command> - shutdown - The guest operating system is in the
     process of being shutdown, rebooted, or suspended, and the virtual
     machine is being stopped.
    </para>
   </listitem>
   <listitem>
    <para>
     <command>c</command> - crashed - The virtual machine has crashed and is
     not running.
    </para>
   </listitem>
   <listitem>
    <para>
     <command>d</command> - dying - The virtual machine is in the process of
     shutting down or crashing.
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
</chapter>
