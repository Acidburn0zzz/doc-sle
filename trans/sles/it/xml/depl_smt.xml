<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<chapter xml:base="depl_smt.xml" id="cha.smt">
 <title>Gestione delle sottoscrizioni</title>

 <para>
  È possibile configurare qualsiasi computer che esegue SUSE Linux Enterprise Server <phrase role="productname"><phrase os="sles;sled;slerte">12</phrase></phrase> o SUSE Linux Enterprise Desktop <phrase role="productname"><phrase os="sles;sled;slerte">12</phrase></phrase> per la registrazione sul server Subscription Management Tool locale in modo che, anziché comunicare direttamente con SUSE Customer Center e i server NU, venga eseguito il download degli aggiornamenti del software. Per utilizzare un server SMT per la registrazione del client e come origine locale per gli aggiornamenti, è necessario prima configurare il server SMT nella rete. Il software del server SMT viene distribuito come componente aggiuntivo per SUSE Linux Enterprise Server e la rispettiva configurazione è descritta nel manuale <emphasis>Subscription Management Tool Guide</emphasis> (Guida relativa a Subscription Management Tool). Non è necessario configurare alcun componente aggiuntivo sui client che devono essere configurati per la registrazione su un server SMT.
 </para>
 <para>
  Per registrare un client su un server SMT, è necessario fornire al client l'URL del server. Dato che client e server comunicano tramite protocollo HTTPS durante la registrazione, è anche necessario accertarsi che il client consideri affidabile il certificato del server. Nel caso in cui il server SMT sia impostato per utilizzare il certificato server di default, il certificato CA sarà disponibile sul server SMT tramite protocollo HTTP in <literal>http://<replaceable>FQDN</replaceable>/smt.crt</literal>. In questo caso non è necessario preoccuparsi del certificato, perché il processo di registrazione provvede automaticamente a effettuare il download del certificato CA da tale ubicazione, se non diversamente configurato. È necessario immettere il percorso del certificato CA se il certificato è stato emesso da un'autorità di certificazione.
 </para>

 <para>
  Vi sono vari modi di fornire queste informazioni e di configurare il computer client per l'utilizzo di SMT. Il primo modo consiste nel fornire le informazioni per mezzo dei parametri del kernel all'avvio. Il secondo modo consiste nel configurare i client utilizzando un profilo AutoYaST. È inoltre disponibile lo script <command>clientSetup4SMT.sh</command>, distribuito con Subscription Management Tool, che può essere eseguito su un client per registrarlo su un server SMT specificato. Questi metodi sono descritti nelle sezioni seguenti:
 </para>
 <sect1 id="smt.client.parameters">
  <title>Utilizzo dei parametri kernel per accedere a un server SMT</title>

  <para>
   È possibile configurare qualsiasi client per l'utilizzo di SMT fornendo i parametri kernel <literal>regurl</literal><literal>regcert</literal> durante l'avvio del computer. Il primo parametro è obbligatorio, mentre il secondo è facoltativo.
  </para>

  <variablelist>
   <varlistentry>
    <term>regurl</term>
    <listitem>
     <para>
      URL del server SMT. Il formato dell'URL deve essere il seguente: <literal>https://<replaceable>FQDN</replaceable></literal>, dove <replaceable>FQDN</replaceable> è il nome host completo del server SMT. Questo deve corrispondere al FQDN del certificato server utilizzato dal server SMT. Esempio:
     </para>
<screen>regurl=https://smt.example.com</screen>
    </listitem>
   </varlistentry>
  </variablelist>

  <warning>
   <title>prestare attenzione agli errori di ortografia</title>
   <para>
    Accertarsi che i valori immessi siano corretti. Se <literal>regurl</literal> non è stato specificato correttamente, la registrazione dell'origine di aggiornamento non riuscirà.
   </para>
  </warning>

  <warning>
   <title>modifica del certificato del server SMT</title>
   <para>
    Se il server SMT riceve un nuovo certificato da un CA nuovo e non attendibile, i client devono recuperare il file del certificato del nuovo CA. Questa operazione viene effettuata automaticamente durante il processo di registrazione, ma solo nel caso in cui al momento dell'installazione sia stato usato un URL per recuperare il certificato oppure se il parametro <literal>regcert</literal> è stato omesso ed è quindi stato utilizzato l'URL di default. Se il certificato è stato caricato utilizzando un altro metodo (ad esempio, utilizzando il percorso locale), il certificato CA non verrà aggiornato.
   </para>
  </warning>
 </sect1>
 <sect1 id="smt.client.autoyast">
  <title>Configurazione dei client con il profilo AutoYaST</title>

  <para>
   I client possono essere configurati in modo da registrarsi con il server SMT tramite profilo AutoYaST. Per informazioni generali sulla creazione di profili AutoYaST e sulla preparazione dell'installazione automatica, fare riferimento al <xref linkend="cha.deployment.autoinst"/>. In questa sezione verrà descritta solo la configurazione specifica SMT.
  </para>

  <para>
   Per configurare i dati specifici per SMT utilizzando AutoYaST, attenersi alla procedura seguente:
  </para>

  <procedure>
   <step performance="required">
    <para>
     Avviare YaST come <systemitem class="username">root</systemitem> e selezionare <menuchoice> <guimenu>Varie</guimenu> <guimenu>Installazione automatica</guimenu> </menuchoice> per avviare il front-end grafico di AutoYaST.
    </para>
    <para>
     Da una riga di comando, è possibile avviare il front-end grafico di AutoYaST utilizzando il comando <command>yast2 autoyast</command>.

    </para>
   </step>
   <step performance="required">
    <para>
     Aprire un profilo esistente utilizzando <menuchoice><guimenu>File</guimenu><guimenu>Apri</guimenu></menuchoice>, creare un profilo basato sulla configurazione corrente del sistema utilizzando <menuchoice><guimenu>Strumenti</guimenu><guimenu>Modifica/crea profilo</guimenu></menuchoice> o lavorare con un profilo vuoto.
    </para>
   </step>
   <step performance="required">
    <para>
     Selezionare <menuchoice><guimenu>Supporto</guimenu><guimenu>Configurazione di SUSE Customer Center</guimenu></menuchoice>. Viene visualizzata una panoramica della configurazione corrente.
    </para>
   </step>
   <step performance="required">
    <para>
     Fare clic su <guimenu>Modifica</guimenu>.
    </para>
   </step>
   <step performance="required">

    <para>
     Per eseguire la registrazione durante l'installazione automatica, selezionare <guimenu>Esegui registrazione prodotto</guimenu>. 
    </para>
   </step>
   <step performance="required">
    <para>
     Impostare l'URL del <guimenu>server SMT</guimenu> e, facoltativamente, l'ubicazione del <guimenu>certificato SMT</guimenu>. I valori possibili sono gli stessi di quelli per il parametro del kernel, vale a dire <literal>regurl</literal>. I valori possibili sono gli stessi di quelli per i parametri del kernel, vale a dire <literal>regurl</literal> e <literal>regcert</literal> (vedere <xref linkend="smt.client.parameters"/>). L'unica eccezione è che il valore <literal>ask</literal> per <literal>regcert</literal> non funziona in AutoYaST, perché richiede l'interazione da parte dell'utente. Nel caso venisse utilizzato, il processo di registrazione verrà saltato.
    </para>
    <para>Se si procede con il processo di registrazione, è possibile che in YaST vengano utilizzati componenti aggiuntivi (estensioni o moduli) di un server di registrazione SUSE Customer Center. Con SUSE Customer Center è possibile registrare e installare nuovi prodotti, ad esempio SUSE Software Development Kit, High Availability, GEO Clustering for SUSE Linux Enterprise High Availability Extension e altri prodotti disponibili direttamente in SUSE Customer Center. Con SUSE Customer Center è addirittura possibile installare il livello patch più recente.
    </para>
   </step>
   <step performance="required">
    <para>
     Eseguire tutte le altre configurazioni necessarie per la distribuzione dei sistemi.
    </para>
   </step>
   <step performance="required">
    <para>
     Selezionare <menuchoice> <guimenu>File</guimenu> <guimenu>Salva con nome</guimenu> </menuchoice> e specificare un nome file per il profilo, ad esempio, <filename>autoinst.xml</filename>.
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 id="smt.client.clientsetupscript">
  <title>Configurazione dei client utilizzando lo script clientSetup4SMT.sh</title>

  <para>
   Con SMT viene fornito lo script <command>/usr/share/doc/packages/smt/clientSetup4SMT.sh</command>. Questo script consente di configurare un computer client in modo da utilizzare un server SMT o di riconfigurarlo per l'utilizzo di un server SMT differente.
  </para>

  <para>
   Per configurare un computer client in modo che utilizzi SMT con lo script <command>clientSetup4SMT.sh</command>, attenersi alla procedura seguente:
  </para>

  <procedure>
   <step performance="required">
    <para>
     Copiare lo script <filename>/usr/share/doc/packages/smt/clientSetup4SMT.sh</filename> dal server SMT al computer client.
    </para>
   </step>
   <step performance="required">
    <para>
     Eseguire lo script sul computer client come <systemitem class="username">root</systemitem>. Lo script può essere eseguito in due modi:
    </para>
    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para>
       Nome dello script seguito dall'URL di registrazione:
      </para>
<screen>./clientSetup4SMT.sh <replaceable>registration_URL</replaceable></screen>
      <para>
       ad esempio:
      </para>
<screen>./clientSetup4SMT.sh  https://smt.example.com/center/regsvc</screen>
     </listitem>
     <listitem>
      <para>
       Nome dello script seguito dall'opzione <option>--host</option> seguita a sua volta dal nome host del server SMT:
      </para>
<screen>./clientSetup4SMT.sh  --host <replaceable>server_hostname</replaceable></screen>
      <para>
       ad esempio:
      </para>
<screen>./clientSetup4SMT.sh --host  smt.example.com</screen>
     </listitem>
    </itemizedlist>
    <para>
     Lo script effettua il download del certificato CA del server.
    </para>
    <important>
     <title>il parametro <option>--host</option></title>
     <para>
      Il nome host da fornire con il parametro <option>--host</option> deve corrispondere a quello dell'host per cui è stato generato il certificato. Inoltre, se il nome del certificato è il nome host completo (ad esempio con l'aggiunta di smt.example.com), deve essere immesso così com'è. Se si immette il nome <quote>breve</quote> (smt), lo script <command>clientSetup4SMT.sh</command> non riesce.
     </para>
    </important>
   </step>
   <step performance="required">
    <para>
     Accettare il certificato CA del server premendo <keycap>y</keycap>.
    </para>
   </step>
   <step performance="required">
    <para>
     Lo script esegue tutte le modifiche necessarie sul client. Se necessario, la registrazione stessa può essere eseguita dallo script.
    </para>
   </step>
   <step performance="required">
    <para>
     
     Effettuare una registrazione eseguendo <command>SUSEConnect</command> sul client.
    </para>
   </step>
  </procedure>




 </sect1>
 <sect1 id="sec.smt.register">
  <title>Registrazione dei client su un ambiente di prova SMT</title>

  

  <para>
   Per configurare un client da registrare su un ambiente di prova anziché un ambiente di produzione, utilizzare <command>SUSEConnect</command> sul computer client:
  </para>

<screen>SUSEConnect -r <replaceable>REG_CODE</replaceable></screen>

  <para>
   Sostituire <replaceable>REG_CODE</replaceable> con il codice di registrazione del proprio prodotto, disponibile sul sito <ulink url="http://scc.suse.com"/>.
  </para>



  <para>
   Per ulteriori informazioni sull'utilizzo di SMT con un ambiente di test, fare riferimento alla <emphasis>Subscription Management Tool Guide</emphasis> (Guida relativa a Subscription Management Tool).
  </para>
 </sect1>
</chapter>
