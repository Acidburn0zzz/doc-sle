<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="apps_librecalc.xml" version="5.0" xml:id="cha.oo.calc">
 <title>LibreOffice Calc</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:bugtracker>
   </dm:bugtracker>
   <dm:translation>yes</dm:translation>
  </dm:docmanager>
 </info>
 <para>
  Calc 是 LibreOffice 电子表格和数据绘图模块。电子表格由一组工作表构成，包含可用元素（如文本、数字或公式）填充的单元格。公式可以操纵其他单元格中的数据，从而为插入它的单元格生成值。Calc 还允许您定义范围、对数据进行过滤和排序、或根据数据创建图表，以便用图形方式来呈现数据。借助数据透视表，您可以合并、分析或比较大量数据。
 </para>
 <para>
  与整个 LibreOffice 套件搭配使用时，Calc 可以跨各种平台加以应用。它可提供多种交换格式（包括导出到 PDF 文档），还能读取 Microsoft Excel 格式的文件以及将文件另存为该格式。其互操作性处于持续改进中。
 </para>
 <para>
  本章仅介绍一些最基本的 Calc 功能。有关详细信息和完整说明，请参见 LibreOffice 帮助或<xref linkend="sec.oo.oview.help"/>中列出的资源。
 </para>
 <note>
  <title>VBA 宏</title>
  <para>
   Calc 可以处理 Excel 文档中的许多 VBA 宏，但对 VBA 宏还不能提供完全的支持。当打开大量使用宏的 Excel 电子表格时，可能会发现其中一些不起作用。
  </para>
 </note>
 <sect1 xml:id="sec.oo.calc.createnew">
  <title>新建文档</title>

  <para>
   可以通过两种方法来创建新 Calc 文档：
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <formalpara>
     <title>全新</title>
     <para>
      要全新创建文档，请单击<menuchoice> <guimenu>文件</guimenu> <guimenu>新建</guimenu> <guimenu>电子表格</guimenu> </menuchoice>，一个新的空 Calc 文档随即创建。
     </para>
    </formalpara>
   </listitem>
   <listitem>
    <formalpara>
     <title>模板</title>
     <para>
      要使用模板，请单击<menuchoice> <guimenu>文件</guimenu> <guimenu>新建</guimenu> <guimenu>模板</guimenu> </menuchoice>，然后打开<guimenu>财务</guimenu>。可以看到电子表格模板的列表。选择适合您的需要的一个模板，随即将根据所选模板的样式创建新文档。
     </para>
    </formalpara>
   </listitem>
  </itemizedlist>

  <para>
   通过单击窗口底部的相应选项卡可访问单张工作表。
  </para>

  <para>
   根据需要在单元格中输入数据。要调整外观，请使用<guimenu>格式</guimenu>工具栏或<guimenu>格式</guimenu>菜单；或者按<xref linkend="sec.oo.calc.styles"/>中所述定义样式。使用<guimenu>文件</guimenu>菜单或工具栏中的相关按钮可打印和保存文档。
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.styles">
  <title>在 Calc 中使用格式和样式</title>

  <para>
   Calc 带有一些内置的单元格和页面样式以改进电子表格和报告的外观。尽管这些内置样式对于许多用途已经足够，但可能发现创建自己常用的格式自选选项很有用。
  </para>

  <procedure xml:id="pro.oo.calc.createstyle">
   <title>创建样式</title>
   <step>
    <para>
     单击<menuchoice><guimenu>格式</guimenu><guimenu>样式和格式</guimenu></menuchoice>。
    </para>
   </step>
   <step>
    <para>
     在<guimenu>样式和格式</guimenu>窗口中，单击顶部的<guimenu>单元样式</guimenu>或<guimenu>页面样式</guimenu>图标。
    </para>
   </step>
   <step>
    <para>
     右键单击<guimenu>样式和格式</guimenu>窗口中样式列表内的任何区域。然后单击<guimenu>新建</guimenu>。
    </para>
   </step>
   <step>
    <para>
     为样式指定一个名称，并使用各个选项卡设置所需的格式选项。
    </para>
   </step>
   <step>
    <para>
     单击<guimenu>确定</guimenu>。
    </para>
   </step>
  </procedure>

  <procedure>
   <title>修改样式</title>
   <step>
    <para>
     单击<menuchoice><guimenu>格式</guimenu><guimenu>样式和格式</guimenu></menuchoice>。
    </para>
   </step>
   <step>
    <para>
     在<guimenu>格式和样式</guimenu>窗口中，单击<guimenu>单元格样式</guimenu>或<guimenu>页面样式</guimenu>图标。
    </para>
   </step>
   <step>
    <para>
     右键单击希望更改的样式的名称，然后单击<guimenu>修改</guimenu>。
    </para>
   </step>
   <step>
    <para>
     更改所需的格式选项。
    </para>
   </step>
   <step>
    <para>
     单击“确定”。
    </para>
   </step>
  </procedure>

  <para>
   要对特定单元格应用样式，请选择要进行格式设置的单元格。然后在<guimenu>样式和格式</guimenu>窗口中双击要应用的样式。
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.sheets">
  <title>处理工作表</title>

  <para>
   工作表是组织计算的好方法。例如，如果您在运营一家公司，每个月创建一张工作表会使会计账目清楚很多。
  </para>

  <para>
   要在电子表格中插入一个新工作表，请执行以下操作：
  </para>

  <remark>
   If you just want to add a new sheet, it is actually much easier to
   use the little + button next to the sheet tabs. But then, of course, you
   don't get all the options. --sknorr, 2015-09-17
  </remark>

  <procedure>
   <title>插入新工作表</title>
   <step>
    <para>
     从主菜单中选择<menuchoice> <guimenu>插入</guimenu> <guimenu>工作表</guimenu> </menuchoice>。随即打开一个对话框。
    </para>
   </step>
   <step>
    <para>
     确定新工作表应放在所选工作表之前还是之后。
    </para>
   </step>
   <step>
    <para>
     如果要创建新工作表，请确保<guimenu>新建工作表</guimenu>单选按钮已激活。输入工作表数和工作表名称。跳过下一步。
    </para>
   </step>
   <step>
    <para>
     如果要从其他文件导入工作表，请执行以下操作，否则请跳过这一步：
    </para>
    <substeps performance="required">
     <step>
      <para>
       选择<guimenu>从文件</guimenu>并单击<guimenu>浏览</guimenu>.
      </para>
     </step>
     <step>
      <para>
       选择文件名并单击<guimenu>确定</guimenu>确认操作。所有工作表名称随即显示在列表中。
      </para>
     </step>
     <step>
      <para>
       通过按 <keycap function="shift"/> 键选择要导入的工作表名称。
      </para>
     </step>
     <step>
      <para>
       单击<guimenu>确定</guimenu>确认以导入所选的工作表名称。
      </para>
     </step>
    </substeps>
   </step>
  </procedure>

  <para>
   要重命名工作表，请在工作表选项卡中右键单击此工作表，并选择<guimenu>重命名工作表</guimenu>。要重命名，您也可以双击工作表选项卡。
  </para>

  <para>
   要删除当前工作表，请选择<menuchoice> <guimenu>编辑</guimenu> <guimenu>工作表</guimenu> <guimenu>删除</guimenu> </menuchoice>并单击<guimenu>删除工作表</guimenu>确认操作。通过按住 <keycap function="shift"/> 键并在工作表选项卡中选择要删除的工作表可以删除多个工作表。右键单击并选择<guimenu>删除工作表</guimenu>，也会显示同样的对话框。单击<guimenu>删除工作表</guimenu>确认操作。
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.condformat">
  <title>条件格式</title>

  <para>
   条件格式是在电子表格中高亮显示特定值的有用功能。例如，定义一个条件，如果此条件为 True，则将对满足此条件的每个单元格应用一种样式。
  </para>

  <note>
   <title>启用自动计算</title>
   <para>
    应用条件格式之前，请选择<menuchoice> <guimenu>工具</guimenu> <guimenu>单元格内容</guimenu> <guimenu>自动计算</guimenu> </menuchoice>。在<guimenu>自动计算</guimenu>前面应显示一个复选标记。
   </para>
  </note>

  <procedure xml:id="pro.oo.calc.condformat">
   <title>使用条件格式</title>
   <step>
    <para>
     首先定义样式。此样式将在条件为 True 时应用于每个单元格。使用<menuchoice> <guimenu>格式</guimenu> <guimenu>样式和格式</guimenu> </menuchoice>或按 <keycap>F11</keycap>。有关详细信息，请参见<xref linkend="pro.oo.calc.createstyle"/>。单击<guimenu>确定</guimenu>进行确认。
    </para>
   </step>
   <step>
    <para>
     选择要应用条件的单元格范围。
    </para>
   </step>
   <step>
    <para>
     从主菜单中选择<menuchoice> <guimenu>格式</guimenu> <guimenu>条件格式</guimenu> <guimenu>条件</guimenu> </menuchoice>。随即打开一个对话框。
    </para>
   </step>
   <step>
    <para>
     现在，您会看到一个新条件的模板。条件可以在多种模式下运行：
    </para>
    <variablelist>
     <varlistentry>
      <term><guimenu>单元格值为</guimenu></term>
      <listitem>
       <para>
        条件将测试某个单元格是否与特定的值匹配。在第一个下拉菜单旁边，您可以选择运算符，如<guimenu>等于</guimenu>、<guimenu>小于</guimenu>或<guimenu>大于</guimenu>。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>公式为</guimenu></term>
      <listitem>
       <para>
        条件将测试特定公式是否返回 True。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>日期为</guimenu></term>
      <listitem>
       <para>
        条件将测试是否达到特定日期值。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term><guimenu>全部单元格</guimenu></term>
      <listitem>
       <remark>
        Imo, this is one of the most interesting LibO features and really needs
        its own procedure. -- sknorr, 2015-09-17
       </remark>
       <para>
        此模式可用于创建依赖于单元格值的数据虚拟化，类似于<guimenu>单元格值为</guimenu>。但是，此处的差别在于，您可以使用一个条件来应用整个样式范围。
       </para>
       
       
      </listitem>
     </varlistentry>
    </variablelist>
   </step>
   <step>
    <para>
     对于本示例，请保留默认值：<guimenu>单元格值为</guimenu>。
    </para>
   </step>
   <step>
    <para>
     选择一个运算符，以及您要测试的单元格值。
    </para>
   </step>
   <step>
    <para>
     选择当条件为 True 时要应用的样式，或单击<guimenu>新建样式</guimenu>以定义新外观。
    </para>
   </step>
   <step>
    <para>
     如果需要更多的条件，请单击<guimenu>添加</guimenu>。然后重复前面的步骤。
    </para>
   </step>
   <step>
    <para>
     单击<guimenu>确定</guimenu>进行确认。现在，单元格的样式已更改。
    </para>
   </step>
  </procedure>

  <remark>
   We might also want a procedure showing how to use the Manage dialog to remove
   conditions. -- sknorr, 2015-09-17
  </remark>
 </sect1>
 <sect1 xml:id="sec.oo.calc.grouping">
  <title>对单元格分组和取消分组</title>

  <para>
   对单元格范围进行分组有助于将电子表格折叠成几部分。这将使电子表格更易阅读，因为您可以隐藏目前不感兴趣的所有部分。可以对行或列进行分组，以及在其他组中嵌套组。
  </para>

  <para>
   要对一个范围进行分组，请执行以下操作：
  </para>

  <procedure>
   <title>对所选单元格范围进行分组</title>
   <step>
    <para>
     在电子表格中选择一个单元格范围。
    </para>
   </step>
   <step>
    <para>
     选择<menuchoice> <guimenu>数据</guimenu> <guimenu>分组和轮廓</guimenu> <guimenu>分组</guimenu> </menuchoice>。一个对话框随即显示。
    </para>
   </step>
   <step>
    <para>
     确定是要按行还是按列对所选范围进行分组。单击<guimenu>确定</guimenu>进行确认。
    </para>
   </step>
  </procedure>

  <para>
   对所选单元格进行分组后，左上页边空白中将出现一条线，指示已分组的单元格范围。使用 <guimenu>+</guimenu> 和 <guimenu>-</guimenu> 图标可折叠或展开此单元格范围。页边左上角的数字显示组的深度，并且也可单击。
  </para>

  <para>
   要对单元格范围取消分组，请单击属于某个组的单元格并依次选择<menuchoice> <guimenu>数据</guimenu> <guimenu>分组和轮廓</guimenu> <guimenu>取消分组</guimenu> </menuchoice>。页边空白中的线随即消失。始终先删除最里面的组。
  </para>
 </sect1>
 <sect1 xml:id="sec.oo.calc.freezing">
  <title>将行或列作为标题冻结</title>

  <para>
   如果电子表格包含大量数据，滚动操作通常会使标题消失。LibreOffice 可锁定行和/或列，以便在您滚动浏览时将其保持固定。
  </para>

  <para>
   要冻结单个行或单个列，请执行以下操作：
  </para>

  <procedure>
   <title>冻结单个行或单个列</title>
   <step>
    <para>
     要在某一行的前面创建冻结区域，请单击行标题（<literal>1</literal>、<literal>2</literal>、<literal>3</literal>...）。
    </para>
    <para>
     要在某一列的上面创建冻结区域，请单击列标题（<literal>A</literal>、<literal>B</literal>、<literal>C</literal>...）。
    </para>
   </step>
   <step>
    <para>
     选择<menuchoice> <guimenu>窗口</guimenu> <guimenu>冻结</guimenu> </menuchoice>。一条灰线将会显示，指示哪个区域已冻结。
    </para>
   </step>
  </procedure>

  <para>
   也可以同时冻结行和列：
  </para>

  <procedure>
   <title>冻结行和列</title>
   <step>
    <para>
     单击要冻结的列右侧和行下方的单元格。例如，如果标题占据从 A1 到 B3 的单元格，请单击单元格 C4。
    </para>
   </step>
   <step>
    <para>
     选择<menuchoice> <guimenu>窗口</guimenu> <guimenu>冻结</guimenu> </menuchoice>。一条灰线将会显示，指示哪个区域已冻结。
    </para>
   </step>
  </procedure>

  <para>
   要取消冻结，请选择<menuchoice> <guimenu>窗口</guimenu> <guimenu>冻结</guimenu> </menuchoice>。菜单中的选中标记随即消失。
  </para>
 </sect1>
</chapter>
