<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="sle_update_migration.xml" version="5.0" xml:id="cha.update.spmigration">
  <title>Migración del paquete de servicios</title>
  <info>
    <abstract>
      <para>SUSE ofrece ahora a los administradores del sistema nuevas herramientas con funciones interesantes para la migración del paquete de servicios. Se trata de sencillas herramientas de línea de comandos, una interfaz gráfica de usuario intuitiva, compatibilidad con la <quote>reversión de cambios</quote> de los paquetes de servicios, etc. En este capítulo se explica cómo realizar paso a paso una migración del paquete de servicios con las nuevas herramientas.</para>
    </abstract>
  </info>

  <sect1 xml:id="sec.update.migr.supported-scenarios-and-versions">
    <title>Escenarios y versiones compatibles</title>
    <para>SUSE admite los siguientes escenarios con conexión o sin ella:</para>

    <variablelist>
      <varlistentry>
        <term>En línea</term>
        <listitem>
          <para>Centro de servicios al cliente de SUSE, Herramienta de gestión de suscripciones (SMT), SUSE Manager.</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Sin conexión</term>
        <listitem>
          <para>DVD de arranque, pen drive USB, imagen ISO, AutoYaST, <quote>RPM simple</quote> y herramientas de otros fabricantes.</para>
        </listitem>
      </varlistentry>
    </variablelist>
    
    <para>Las siguientes versiones son compatibles:</para>
    
    <variablelist>
      <varlistentry>
        <term>En línea</term>
        <listitem>
          <para>SUSE Linux Enterprise 12</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Sin conexión</term>
        <listitem>
          <para>SUSE Linux Enterprise 11 SP3/SP4, SUSE Linux Enterprise 12</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Manual/Otros fabricantes</term>
        <listitem>
          <para>SUSE Linux Enterprise 12</para>
        </listitem>
      </varlistentry>
    </variablelist>
  </sect1>

  <sect1 xml:id="sec.update.migr.workflow">
    <title>Flujo de trabajo de migración del paquete de servicios</title>
    <para>Es posible ejecutar una migración del paquete de servicios mediante YaST, <command>zypper</command>, AutoYaST, RPM o con herramientas de otros fabricantes. En este capítulo solo se describen las dos primeras. Independientemente del método utilizado, la migración de un paquete de servicios consta de los pasos siguientes:</para>
    <orderedlist>
      <listitem>
        <para>Buscar los posibles destinos de migración.</para>
      </listitem>
      <listitem>
        <para>Seleccionar un destino de migración.</para>
      </listitem>
      <listitem>
        <para>Pedir y habilitar nuevos repositorios.</para>
      </listitem>
      <listitem>
        <para>Ejecutar la migración.</para>
      </listitem>
    </orderedlist>

    
    <para>La lista de destinos de migración depende de los productos que haya instalado. Si tiene una extensión instalada para la que aún no haya disponible un paquete de servicios nuevo, puede que no se le ofrezca ningún destino de migración.</para>
    <para>La lista de destinos de migración disponibles para el host se obtiene siempre del Centro de servicios al cliente de SUSE, depende de los productos o extensiones instalados y puede cambiar con el tiempo; lo que significa que, por ejemplo, la migración de SLE12 GA a SP2 puede ser posible para un host, pero no para otro.</para>
  </sect1>

  <sect1 xml:id="sec.update.migr.yast.onlinemigr">
    <title>Migración con YaST (herramienta Migración en línea)</title>
    <para>A fin de realizar la migración de un paquete de servicios con YaST, use la herramienta <guimenu>Migración en línea</guimenu>. Por defecto, YaST no instala ningún paquete desde repositorios de otros fabricantes. Si se ha instalado un paquete desde un repositorio de otro fabricante, YaST impide que los paquetes se sustituyan por los mismos paquetes provenientes de SUSE.
    </para>
    <procedure xml:id="pro.update.migr.yast">
      <step>
        <para>Instale las actualizaciones más recientes para obtener el módulo <guimenu>Migración en línea</guimenu>.</para>
      </step>
      <step>
        <para>Instale el paquete <package>yast2-migration</package>
          y sus dependencias. </para>
      </step>
      <step>
        <para>Reinicie YaST, o el módulo recién instalado no se mostrará en el Centro de control.</para>
      </step>
      <step>
        <para>Inicie el módulo <guimenu>Migración en línea</guimenu> en la sección <guimenu>Sistema</guimenu> de YaST. </para>
        <para>YaST muestra los destinos de migración posibles y un resumen.</para>
      </step>
      <step>
        <para>Seleccione un destino de migración y haga clic en <guimenu>Siguiente</guimenu>.</para>
      </step>
      <step>
        <para>En caso de que la herramienta Migración en línea ofrezca repositorios de actualización, elija si desea utilizarlos. Se recomienda continuar con la opción <guimenu>Sí</guimenu>.
          
        </para>
      </step>
      <step>
        <para><remark>toms 2015-09-09: FATE#319140</remark> Si la herramienta Migración en línea encuentra repositorios obsoletos provenientes del DVD o de un servidor local, se recomienda encarecidamente inhabilitarlos. Los repositorios antiguos del Centro de servicios al cliente de SUSE o de la Herramienta de gestión de suscripciones se eliminan automáticamente.
        </para>
      </step>
      <step>
        <para>Revise el resumen y haga clic en <guimenu>Siguiente</guimenu> para continuar con la migración. Para confirmar, haga clic en <guimenu>Iniciar actualización</guimenu>.</para>
      </step>
      <step>
        <para>Cuando se complete correctamente la migración, reinicie el sistema.</para>
      </step>
    </procedure>
  </sect1>

  <sect1 xml:id="sec.update.migr.zypper.onlinemigr">
    <title>Migración con Zypper</title>
    <para>A fin de realizar la migración de un paquete de servicios mediante Zypper, use la herramienta de línea de comandos <command>zypper</command> <option>migration</option>.</para>
    <procedure>
      <step>
        <para>Entre a la sesión en el equipo con SUSE Linux Enterprise 12.</para>
      </step>
      <step>
        <para>Instale las actualizaciones más recientes.</para>
      </step>
      <step>
        <para>Instale los paquetes
            <package>zypper-migration-plugin</package> y sus dependencias. </para>
      </step>
      <step>
        <para>Ejecute <command>zypper</command> <option>migration</option>:</para>
        <screen><prompt>root # </prompt><command>zypper</command> migration
Executing 'zypper  patch-check'

Refreshing service 'SUSE_Linux_Enterprise_Server_12_x86_64'.
Loading repository data...
Reading installed packages...
0 patches needed (0 security patches)

Available migrations:

    1 | SUSE Linux Enterprise Server 12 SP1 x86_64</screen>
        <remark>toms 2015-09-07: From FATE#319128</remark>
        <para>Por defecto, Zypper usa la opción <option>--no-allow-vendor-change</option>, que se pasa a <command>zypper</command> <option>dup</option>. Si se ha instalado un paquete desde un repositorio de otro fabricante, esta opción impide que los paquetes se sustituyan por los mismos paquetes provenientes de SUSE.
        </para>
      </step>
      <step>
        <para>
        <remark>toms 2015-09-09: FATE#319140</remark> Si Zypper encuentra repositorios obsoletos provenientes del DVD o de un servidor local, se recomienda encarecidamente inhabilitarlos. Los repositorios del SCC o de la SMT antiguos se eliminan automáticamente.
        </para>
      </step>
      <step>
        <para>Revise todos los cambios, sobre todo los paquetes que se van a eliminar. Para continuar, escriba <literal>y</literal> (el número exacto de paquetes para actualizar puede variar en su sistema):</para>
        <screen>266 packages to upgrade, 54 to downgrade, 17 new, 8 to reinstall, 5 to remove, 1 to change arch.
Overall download size: 285.1 MiB. Already cached: 0 B  After the operation, additional 139.8 MiB will be used.
Continue? [y/n/? shows all options] (y):</screen>
        <para>Use las teclas <keycombo> <keycap function="shift"/> <keycap function="pageup"/> </keycombo> o <keycombo> <keycap function="shift"/> <keycap function="pagedown"/> </keycombo> para desplazarse por la shell.</para>
      </step>
      <step>
        <para>Cuando se complete correctamente la migración, reinicie el sistema.</para>
      </step>
    </procedure>
  </sect1>

</chapter>
