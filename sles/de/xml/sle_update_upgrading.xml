<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="sle_update_upgrading.xml" version="5.0" xml:id="cha-update-sle">
 <title>Aufrüsten von SUSE Linux Enterprise</title>
 <info>
  <abstract>
   <para>
    SUSE® Linux Enterprise (SLE) ermöglicht die Aktualisierung eines vorhandenen Systems auf die neue Version, zum Beispiel von SLE 11 SP4 zu SLE 12. Es ist keine neue Installation erforderlich. Bestehende Daten wie Home- und Datenverzeichnisse sowie Systemkonfigurationen bleiben erhalten. Sie können die Aktualisierung von einem lokalen CD- oder DVD-Laufwerk oder von einer zentralen Netzwerkinstallationsquelle durchführen.
   </para>

   <para>
    In diesem Kapitel erfahren Sie, wie Sie das SUSE Linux Enterprise-System manuell per DVD, über das Netzwerk, mit einem automatisierten Prozess oder mit SUSE Manager aufrüsten.
   </para>
  </abstract>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:translation>Ja</dm:translation>
  </dm:docmanager>
 </info>
 <sect1 xml:id="sec-update-prep">
  <title>Allgemeine Vorbereitungen</title>

  <para>
   Vor Beginn der Aktualisierung muss das System ordnungsgemäß vorbereitet werden. Zur Vorbereitung gehören unter anderem das Sichern der Daten und das Lesen der Versionshinweise.
  </para>

  <sect2 xml:id="sec-update-prep-multiversion">
   <title>Vorübergehende Deaktivierung der Unterstützung mehrerer Kernel-Versionen</title>
   <para>
    <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> ermöglicht die Installation mehrerer Kernel-Versionen. Hierfür müssen die entsprechenden Einstellungen in <filename>/etc/zypp/zypp.conf</filename> aktiviert werden. Für die Aktualisierung auf einen Service Pack muss diese Funktion vorübergehend deaktiviert werden. Sobald die Aktualisierung erfolgreich abgeschlossen wurde, kann die Unterstützung mehrerer Versionen wieder aktiviert werden. Zur Deaktivierung der Unterstützung mehrerer Versionen müssen die entsprechenden Zeilen in der Datei <filename>/etc/zypp/zypp.conf</filename> auf Kommentar gesetzt werden. Das Ergebnis sollte folgendermaßen aussehen:
   </para>
<screen>#multiversion = provides:multiversion(kernel)
#multiversion.kernels = latest,running</screen>
   <para>
    Wenn Sie diese Funktion nach einer erfolgreichen Aktualisierung wieder aktivieren möchten, entfernen Sie die Kommentarzeichen. Weitere Informationen zur Unterstützung mehrerer Versionen finden Sie in <xref linkend="cha-tuning-multikernel-enable"/>.
   </para>
  </sect2>

  <sect2 xml:id="sec-update-prep-relnotes">
   <title>Lesen Sie die Versionshinweise</title>
   <para>
    In den Versionshinweisen finden Sie zusätzliche Informationen zu den Änderungen, die seit der vorigen Version von SUSE Linux Enterprise vorgenommen wurden. Ermitteln Sie anhand dieser Hinweise, ob Ihre Hardware oder Einrichtung überarbeitet werden muss, welche Ihrer bevorzugten Softwarepakete maßgeblich geändert wurden und welche Vorkehrungen Sie zusätzlich zu den allgemeinen Empfehlungen in diesem Abschnitt treffen sollten. In den Versionshinweisen finden Sie auch Informationen und Probleme, die erst nach der Fertigstellung des Handbuchs bekannt wurden.
   </para>
   <para>
    Die aktuelle Fassung der Versionshinweise mit den neuesten Informationen zu <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> finden Sie online unter <link xlink:href="http://www.suse.com/documentation/"/>.
   </para>
  </sect2>

  <sect2 xml:id="sec-update-prep-backup">
   <title>Anlegen einer Sicherungskopie</title>
   <para>
    Kopieren Sie die bestehenden Konfigurationsdateien vor der Aktualisierung auf ein separates Medium (wie ein Bandlaufwerk oder eine externe Festplatte), um die Daten zu sichern. Dies gilt hauptsächlich für die in <filename>/etc</filename> gespeicherten Dateien sowie für bestimmte Verzeichnisse und Dateien in <filename>/var</filename> und <filename>/opt</filename>. Zudem empfiehlt es sich, die Benutzerdaten in <filename>/home</filename> (den <envar>HOME</envar>-Verzeichnissen) auf ein Sicherungsmedium zu schreiben. Melden Sie sich zur Sicherung dieser Daten als <systemitem class="username">root</systemitem> an. Nur der Benutzer <systemitem class="username">root</systemitem> verfügt über die Leseberechtigung für alle lokalen Dateien.
   </para>
   <para>
    Wenn Sie in YaST den Installationsmodus <guimenu>Vorhandenes System aktualisieren</guimenu> ausgewählt haben, können Sie später wahlweise eine (System-)Sicherung ausführen. Sie können alle geänderten Dateien und die Dateien aus dem Verzeichnis <filename>/etc/sysconfig</filename> einschließen. Dies ist allerdings keine vollständige Sicherung, da alle anderen wichtigen, oben genannten Verzeichnisse außer Acht gelassen werden. Die Sicherungskopie befindet sich im Verzeichnis<filename>/var/adm/backup</filename>.
   </para>
  </sect2>

  <sect2 xml:id="sec-update-prep-mariadb">
   <title>Migration der MySQL-Datenbank</title>
   <remark>toms 2015-09-03: already reviewed by Ondrej and Kristýna.</remark>
   <para>
    Ab SUSE Linux Enterprise 12 hat SUSE von MySQL auf MariaDB umgestellt. Bevor Sie die Aufrüstung starten, wird dringend empfohlen, die Datenbank zu sichern.
   </para>

   <para>
    So führen Sie die Datenbankmigration aus:
   </para>
   <procedure>
    <step>
     <para>
      Melden Sie sich auf dem SUSE Linux Enterprise 11-Computer an.
     </para>
    </step>
    <step>
     <para>
      Erstellen Sie eine Dump-Datei:
     </para>
<screen><prompt>root # </prompt><command>mysqldump</command> -u root -p --all-databases &gt; mysql_backup.sql</screen>
     <para>
      Standardmäßig wird die Datenbank <literal>INFORMATION_SCHEMA</literal> oder <literal>performance_schema</literal> nicht im Speicherauszug mit <command>mysqldump</command> berücksichtigt. Weitere Einzelheiten finden Sie unter <link xlink:href="https://dev.mysql.com/doc/refman/5.5/en/mysqldump.html"/>.
     </para>
    </step>
    <step>
     <para>
      Legen Sie die Dump-Datei, die Konfigurationsdatei <filename>/etc/my.cnf</filename> und das Verzeichnis <filename>/etc/mysql/</filename> zur späteren Untersuchung (<emphasis>NICHT</emphasis> Installation!) an einem sicheren Speicherort ab.
     </para>
    </step>
    <step>
     <para>
      Führen Sie die Aufrüstung aus. Nach der Aufrüstung ist die bisherige Konfigurationsdatei <filename>/etc/my.cnf</filename> unverändert. Die neue Konfiguration finden Sie in der Datei <filename>/etc/my.cnf.rpmnew</filename>.
     </para>
    </step>
    <step>
     <para>
      Konfigurieren Sie die MariaDB-Datenbank je nach Bedarf. Bearbeiten Sie dabei <emphasis>NICHT</emphasis> die bisherige Konfigurationsdatei und das frühere Verzeichnis, sondern nutzen Sie diese nur als Vorlage, und passen Sie die Einstellungen entsprechend an.
     </para>
    </step>
    <step>
     <para>
      Starten Sie den MariaDB-Server:
     </para>
<screen><prompt>root # </prompt><command>systemctl</command> start mysql</screen>
     <para>
      Soll der MariaDB-Server bei jedem Booten gestartet werden, aktivieren Sie den Dienst:
     </para>
<screen><prompt>root # </prompt><command>systemctl</command> enable mysql</screen>

    </step>
    <step>
     <para>
      Prüfen Sie, ob MariaDB ordnungsgemäß ausgeführt wird. Stellen Sie hierzu eine Verbindung zur Datenbank her:
     </para>
<screen><prompt>root # </prompt><command>mysql</command> -u root -p</screen>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="sec-update-prep-postgresql">
   <title>Migration der PostgreSQL-Datenbank</title>
   <remark>toms 2015-09-09: FATE#319049</remark>
   <remark>Already reviewd by Reinhard</remark>
   <para>
    SLE11 SP3 und SLE12 GA erhalten eine neuere Version der PostgreSQL-Datenbank als Wartungsaktualisierung. Aufgrund der erforderlichen Migrationsschritte für die Datenbank ist kein automatischer Upgradevorgang verfügbar. Die Umstellung auf die neue Version muss daher manuell erfolgen.
   </para>
   <para>
    Der Migrationsvorgang wird mit dem Befehl <command>pg_upgrade</command> ausgeführt. Dieser Befehl ist eine alternative Methode zur bewährten Methode mit Erstellen eines Speicherauszugs und Neuladen. Im Vergleich zu <quote>Speicherauszug und Neuladen</quote> ist die Migration mit <command>pg_upgrade</command> weniger zeitaufwändig.
   </para>
   <para>
    Die Dateien der verschiedenen PostgreSQL-Versionen sind jeweils in verschiedenen versionsabhängigen Verzeichnissen gespeichert. Nach der Aktualisierung gelten die folgenden neuen Verzeichnisse:
   </para>
   <variablelist>
    <varlistentry>
     <term>SLE11 SP3/SP4</term>
     <listitem>
      <para>
       <filename>/usr/lib/postgresql91/</filename> to <filename>/usr/lib/postgresql94/</filename>
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>SLE12 GA</term>
     <listitem>
      <para>
       <filename>/usr/lib/postgresql93/</filename> to <filename>/usr/lib/postgresql94/</filename>
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    So führen Sie die Datenbankmigration aus:
   </para>
   <procedure>
    <step>
     <para>
      Prüfen Sie, ob die folgenden Voraussetzungen erfüllt sind:
     </para>
     <itemizedlist>
      <listitem>
       <para>
        Rüsten Sie alle Pakete der alten PostgreSQL-Version per Wartungsaktualisierung auf die aktuelle Version auf, sofern Sie dies noch nicht erledigt haben.
       </para>
      </listitem>
      <listitem>
       <para>
        Erstellen Sie eine Sicherung der vorhandenen Datenbank.
       </para>
      </listitem>
      <listitem>
       <para>
        Installieren Sie die Pakete der neuen PostgreSQL-Hauptversion. Bei SLE 12 installieren Sie
        <package>postgresql94-server</package>
        und alle Pakete, von denen dieses Paket abhängig ist.
       </para>
      </listitem>
      <listitem>
       <para>
        Installieren Sie das Paket
        <package>postgresql94-contrib</package>
        (enthält den Befehl <command>pg_upgrade</command>).
       </para>
      </listitem>
      <listitem>
       <para>
        Prüfen Sie, ob ausreichend freier Speicherplatz im PostgreSQL-Datenbereich verfügbar ist (standardmäßig <filename>/var/lib/pgsql/data</filename>). Falls der Speicherplatz nicht ausreicht, versuchen Sie, die einzelnen Datenbanken mit dem folgenden SQL-Befehl zu verkleinern (kann sehr lange dauern!):
       </para>
<screen>VACUUM FULL</screen>
      </listitem>
     </itemizedlist>
    </step>
    <step>
     <para>
      Halten Sie den PostgreSQL-Server an:
     </para>
<screen><prompt>root # </prompt><command>/usr/sbin/rcpostgresql</command> stop</screen>
    </step>
    <step>
     <para>
      Benennen Sie das alte Datenverzeichnis um:
     </para>
<screen><prompt>root # </prompt><command>mv</command> /var/lib/pgsql/data /var/lib/pgsql/data.old</screen>
    </step>
    <step>
     <para>
      Erstellen Sie ein neues Datenverzeichnis:
     </para>
<screen><prompt>root # </prompt><command>mkdir</command> -p /var/lib/pgsql/data</screen>
    </step>
    <step>
     <para>
      Wenn Sie die Konfigurationsdateien in der alten Version geändert hatten, kopieren Sie die Dateien <filename>postgresql.conf</filename> und <filename>pg_hba.conf</filename> in das neue Verzeichnis <filename>data</filename>:
     </para>
<screen><prompt>root # </prompt><command>cp</command> /var/lib/pgsql/data.old/*.conf \
     /var/lib/pgsql/data</screen>
    </step>
    <step>
     <para>
      Initialisieren Sie die neue Datenbankinstanz manuell mit <command>initdb</command> oder starten und stoppen Sie PostgreSQL, wodurch die Instanz automatisch initialisiert wird:
     </para>
<screen><prompt>root # </prompt><command>/usr/sbin/rcpostgresql</command> start
<prompt>root # </prompt><command>/usr/sbin/rcpostgresql</command> stop</screen>
    </step>
    <step>
     <para>
      Starten Sie den Migrationsvorgang und ersetzen Sie den Platzhalter <replaceable>OLD</replaceable> durch die ältere Version:
     </para>
<screen><prompt>root # </prompt><command>pg_upgrade</command> \
   --old-datadir "/var/lib/pgsql/data.old" \
   --new-datadir "/var/lib/pgsql/data" \
   --old-bindir "/usr/lib/postgresql<replaceable>OLD</replaceable>/bin/" \
   --new-bindir "/usr/lib/postgresql94/bin/"</screen>
    </step>
    <step>
     <para>
      Starten Sie die neue Datenbankinstanz:
     </para>
<screen><prompt>root # </prompt><command>/usr/sbin/rcpostgresql</command> start</screen>
    </step>
    <step>
     <para>
      Überprüfen Sie, ob die Migration erfolgreich war. Für diesen Schritt gibt es kein automatisiertes Tool. Der Umfang und die Elemente für den Test sind abhängig von Ihrem jeweiligen Anwendungsfall.
     </para>
    </step>
    <step>
     <para>
      Entfernen Sie alle alten PostgreSQL-Pakete und das alte Datenverzeichnis:
     </para>
<screen><prompt>root # </prompt><command>zypper</command> search -s postgresql<replaceable>OLD</replaceable> | xargs zypper rm -u
<prompt>root # </prompt><command>rm</command> -rf /var/lib/pgsql/data.old</screen>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="sec-update-prep-ssl">
   <title>Erstellen von Nicht-MD5-Server-Zertifikaten für Java-Anwendungen</title>
   <remark>toms 2016-07-27: from bsc#970153, c#24</remark>
   <para>
    Beim Update von SP1 auf SP2 wurden MD5-basierte Zertifikate im Rahmen eines Sicherheits-Fixes deaktiviert. Wenn Sie über als MD5 erstellte Zertifikate verfügen, erstellen Sie diese mit folgenden Schritten neu:
   </para>
   
   <procedure>
    <step>
     <para>
      Öffnen Sie ein Terminal und melden Sie sich als <systemitem class="username">root</systemitem> an.
     </para>
    </step>
    <step>
     <para>
      Erstellen Sie einen privaten Schlüssel:
     </para>
     <screen><prompt>root # </prompt><command>openssl</command> genrsa -out server.key 1024</screen>
     <para>
      Wenn Sie einen Schlüssel mit höherer Sicherheit wünschen, ersetzen Sie <literal>1024</literal> durch eine höhere Zahl, z. B. <literal>4096</literal>.
     </para>
    </step>
    <step>
     <para>
      Erstellen Sie einen Zertifizierungsantrag (CSR):
     </para>
     <screen><prompt>root # </prompt><command>openssl</command> req -new -key server.key -out server.csr</screen>
    </step>
    <step>
     <para>
      Führen Sie eine Eigensignierung des Zertifikats durch:
     </para>
     <screen><prompt>root # </prompt><command>openssl</command> x509 -req -days 365 -in server.csr -signkey server.key -out server.crt</screen>
    </step>
    <step>
     <para>
      Erstellen Sie die PEM-Datei:
     </para>
     <screen><prompt>root # </prompt><command>cat</command> server.key server.crt &gt; server.pem</screen>
    </step>
    <step>
     <para>Legen Sie die Dateien <filename>server.crt</filename>, <filename>server.csr</filename>, <filename>server.key</filename> und <filename>server.pem</filename> in den jeweiligen Verzeichnissen ab, in denen die Schlüssel gefunden werden können. Für Tomcat beispielsweise lautet das Verzeichnis <filename>/etc/tomcat/ssl/</filename>.
     </para>
    </step>
   </procedure>
  </sect2>
  
  <sect2 xml:id="sec-update-prep-vms">
   <title>Herunterfahren von VM-Gästen</title>
   <para>
    Wenn Ihr Rechner als VM-Hostserver für KVM oder Xen fungiert, müssen Sie vor der Aktualisierung alle aktiven VM-Gäste ordnungsgemäß herunterfahren. Andernfalls können Sie nach der Aktualisierung wahrscheinlich nicht mehr auf die Gäste zugreifen.
   </para>
  </sect2>

  <sect2 xml:id="sec-update-prep-smt">
   <title>Prüfen des Skripts <command>clientSetup4SMT.sh</command> auf SMT-Clients</title>
   <para>
    Wenn Sie Ihr bei einem SMT-Server registriertes Clientbetriebssystem migrieren möchten, müssen Sie prüfen, ob die Version des Skripts <command>clientSetup4SMT.sh</command> auf dem Host aktuell ist. <command>clientSetup4SMT.sh</command> aus älteren Versionen von SMT kann nicht zum Verwalten von SMT 12-Clients verwendet werden. Wenn Sie auf Ihrem SMT-Server regelmäßig Software-Patches anwenden, finden Sie die neueste Version von <command>clientSetup4SMT.sh</command> immer unter <filename>&lt;SMT_HOSTNAME&gt;/repo/tools/clientSetup4SMT.sh</filename>.
   </para>
  </sect2>
 </sect1>
 <sect1 xml:id="sec-update-disk">
  <title>Festplattenspeicher</title>

  <para>
   Software weist normalerweise von Version zu Version mehr <quote>Umfang</quote> auf. Folglich sollten Sie vor dem Aktualisieren den verfügbaren Partitionsspeicher überprüfen. Wenn Sie befürchten, dass der Speicherplatz nicht ausreicht, sichern Sie Ihre Daten und erhöhen Sie dann den verfügbaren Speicherplatz, indem Sie beispielsweise die Größe von Partitionen ändern. Es gibt keine Faustregel hinsichtlich des Speicherplatzes einzelner Partitionen. Die Platzanforderungen hängen von Ihrem bestimmten Partitionsprofil und von der ausgewählten Software ab.
  </para>

  <note>
   <title>Automatische Prüfung des verfügbaren Speicherplatzes in YaST</title>
   <para>
    YaST prüft während des Aktualisierungsvorgangs den freien Speicherplatz und zeigt dem Benutzer eine Warnmeldung an, wenn die verfügbare Menge möglicherweise nicht für die Installation ausreicht. Wenn Sie die Aktualisierung in diesem Fall dennoch durchführen, kann das <emphasis>System unbrauchbar</emphasis> werden! Sie sollten die Warnmeldung nur dann ignorieren und mit der Aktualisierung fortfahren, wenn Sie genau wissen, was Sie tun (da Sie dies in einem Vorabtest abgeklärt haben).
   </para>
  </note>

  <sect2 xml:id="sec-update-disk-space">
   <title>Ermitteln des freien Speicherplatzes auf Nicht-Btrfs-Dateisystemen</title>
   <para>
    Listen Sie mit dem Kommando <command>df</command> den verfügbaren Speicherplatz auf. In <xref linkend="aus-update-df"/> ist beispielsweise <filename>/dev/sda3</filename> die Root-Partition (eingehängt als <filename>/</filename>).
   </para>
   <example xml:id="aus-update-df">
    <title>Über <command>df -h</command> angezeigte Liste</title>

<screen os="sles">Filesystem     Size  Used Avail Use% Mounted on
/dev/sda3       74G   22G   53G  29% /
tmpfs          506M     0  506M   0% /dev/shm
/dev/sda5      116G  5.8G  111G   5% /home
/dev/sda1       44G    4G   40G   9% /data</screen>
   </example>
  </sect2>

  <sect2 xml:id="sec-update-disk-btrfs-on-root">
   <title>Ermitteln des freien Speicherplatzes auf Btrfs-Root-Dateisystemen</title>
   <para>
    Wenn Sie Btrfs als Root-Dateisysteme auf dem Computer nutzen, muss ausreichend freier Speicherplatz zur Verfügung stehen. Mit den folgenden beiden Befehlen ermitteln Sie den Speicherplatz:
   </para>
<screen><prompt>root # </prompt><command>btrfs</command> filesystem df /
<prompt>root # </prompt><command>df</command> /</screen>
   <para>
    Die beiden Befehle liefern ähnliche Angaben über den belegten Speicherplatz. Allerdings besteht bei Btrfs das Problem, dass nicht bekannt ist, welche Elemente in einem Snapshot referenziert werden und welche nicht. Es ist also nicht möglich, den Speicherplatz zu berechnen, der für eine Änderung erforderlich ist.
   </para>
   <para>
    Im schlimmsten Fall belegt eine Aufrüstung ebenso viel Speicherplatz wie das aktuelle Root-Dateisystem (ohne <filename>/.snapshot</filename>). Ermitteln Sie den freien Speicherplatz nicht nur für die Btrfs-Dateisysteme, sondern auch für andere Dateisysteme. Die folgende Empfehlung hat sich bewährt:
   </para>
   <itemizedlist>
    <listitem>
     <para>
      Bei allen Dateisystemen (auch Btrfs) benötigen Sie ausreichend freien Speicherplatz, damit Sie große RPMs herunterladen und installieren können. Der Speicherplatz der alten RPMs wird erst dann freigegeben, wenn die neuen RPMs installiert sind.
     </para>
    </listitem>
    <listitem>
     <para>
      Bei Btrfs mit Snapshots benötigen Sie mindestens so viel freien Speicherplatz, wie von der aktuellen Installation belegt wird. Es wird mindestens die doppelte Menge an freiem Speicherplatz empfohlen, wie von der aktuellen Installation belegt wird.
     </para>
     <para>
      Falls nicht ausreichend freier Speicherplatz verfügbar ist, können Sie ältere Snapshots wie folgt mit <command>snapper</command> löschen:
     </para>
<screen><prompt>root # </prompt><command>snapper</command> list
<prompt>root # </prompt><command>snapper</command> delete NUMBER</screen>
     <para>
      Dies reicht jedoch nicht in allen Fällen aus. Vor der Migration belegen die meisten Snapshots nur wenig Platz.
     </para>
    </listitem>
   </itemizedlist>
  </sect2>
 </sect1>
 <sect1 xml:id="sec-update-proc-prep-paths">
  <title>Unterstützte Aufrüstungspfade für SLE</title>

  <important>
   <title>Architekturübergreifende Aufrüstungen werden nicht unterstützt</title>
   <para>
    Architekturübergreifende Aufrüstungen wie von einer 32-Bit-Version von <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> auf die 64-Bit-Version oder die Aufrüstung von Big Endian auf Little Endian werden <emphasis>nicht</emphasis> unterstützt.
   </para>
   <para>
    Insbesondere SLE 11 unter POWER (Big Endian) auf SLE 12 SP1 unter POWER (neu: Little Endian) wird <emphasis>nicht</emphasis> unterstützt.
   </para>
   <para>
    Da SUSE Linux Enterprise 12 nur in der 64-Bit-Version verfügbar ist, werden Aufrüstungen von 32-Bit-Systemen von SUSE Linux Enterprise 11 auf SUSE Linux Enterprise 12 und höher <emphasis>nicht</emphasis> unterstützt.
   </para>
  </important>

  <para>
   Vor der Migration beachten Sie <xref linkend="sec-update-prep"/>.
  </para>

  <variablelist>
   <varlistentry>
    <term>Aufrüsten von SUSE Linux Enterprise 10 (mit beliebigem Service Pack)</term>
    <listitem>
     <para>
      Es gibt keinen unterstützten direkten Migrationspfad zu SUSE Linux Enterprise 12. Stattdessen wird eine Neuinstallation empfohlen.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Aufrüsten von SUSE Linux Enterprise 11 GA, SP1 oder SP2</term>
    <listitem>
     <para>
      Es gibt keinen unterstützten direkten Migrationspfad zu SUSE Linux Enterprise 12. Zum Aufrüsten auf SLE 12 muss mindestens SLE 11 SP3 vorliegen.
     </para>
     <para>
      Falls Sie keine Neuinstallation ausführen können, müssen Sie zunächst von SLE 11 GA auf SP1 aufrüsten, dann von SLE 11 SP1 auf SP2 und schließlich von SLE 11 SP2 auf SP3. Diese Schritte werden im <link xlink:href="https://www.suse.com/documentation/sles11/">SUSE Linux Enterprise 11-Bereitstellungshandbuch</link> beschrieben.
     </para>
     <para>
      Fahren Sie anschließend mit <xref linkend="sec-update-sle12"/> fort.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Aufrüsten von SUSE Linux Enterprise 11 SP3 oder SP4</term>
    <listitem>
     <para>
      Weitere Informationen finden Sie unter <xref linkend="sec-update-sle12"/>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Aufrüsten von SUSE Linux Enterprise 12 auf SP1</term>
    <listitem>
     <para>
      Weitere Informationen finden Sie unter <xref linkend="cha-update-spmigration"/>.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect1>
 <sect1 xml:id="sec-update-sle12">
  <title>Unterstützte Methoden zum Aufrüsten von SUSE Linux Enterprise</title>

  <remark>toms 2014-02-11: See FATEs #315969 and #313189</remark>

  <para>
   Das Aufrüsten von SUSE Linux Enterprise 11 SP3 auf SUSE Linux Enterprise 12, SUSE Linux Enterprise 11 SP3 auf SUSE Linux Enterprise 12 SP1 sowie SUSE Linux Enterprise 11 SP4 auf SUSE Linux Enterprise 12 SP1 wird mit einer der folgenden Methoden unterstützt:
  </para>

  <itemizedlist>
   <listitem>
    <para>
     <xref linkend="sec-update-sle12-manual" xrefstyle="HeadingOnPage"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="sec-update-sle12-automated" xrefstyle="HeadingOnPage"/>
    </para>
   </listitem>
  </itemizedlist>
 </sect1>
 <sect1 xml:id="sec-update-sle12-manual">
  <title>Manuelle Aufrüstung von SLE 11 SP3 auf SLE 12 SP1 mit einer Installationsquelle</title>

  <para>
   Vor dem Aufrüsten des Systems beachten Sie <xref linkend="sec-update-prep"/> 
  </para>

  <para>
   Zur Aufrüstung des Systems mit dieser Methode müssen Sie den Computer von einer Installationsquelle starten (wie bei einer Neuinstallation). Im Bootbildschirm wählen Sie dabei jedoch <guimenu>Aufrüsten</guimenu> (statt <guimenu>Installation</guimenu>). Sie können von den folgenden Installationsquellen booten:
  </para>

  <itemizedlist>
   <listitem>
    <para>
     Ein lokales Installationsmedium (z. B. eine DVD oder ein ISO-Image auf einem USB-Massenspeichergerät). Weitere Anweisungen finden Sie unter <xref linkend="sec-update-sle12-manual-dvd"/>.
    </para>
   </listitem>
   <listitem>
    <para>
     Eine Netzwerkinstallationsquelle. Sie können wahlweise vom lokalen Medium booten und dann den entsprechenden Netzwerkinstallationstyp auswählen oder über PXE booten. Weitere Anweisungen finden Sie unter <xref linkend="sec-update-sle12-manual-network"/>.
    </para>
   </listitem>
  </itemizedlist>

  <sect2 xml:id="sec-update-sle12-manual-dvd">
   <title>Aufrüsten von einem Installationsmedium</title>
   <para>
    Im nachfolgenden Verfahren wird das Booten von DVD als Beispiel beschrieben. Sie können jedoch auch ein anderes lokales Installationsmedium verwenden, z. B. ein ISO-Image auf einem USB-Massenspeichergerät. Das Verfahren zum Auswählen der Bootmethode und zum Starten des Systems vom Medium hängt von der Systemarchitektur und davon ab, ob der Computer mit einem herkömmlichen BIOS oder mit UEFI ausgestattet ist. Weitere Informationen finden Sie unter den nachfolgenden Links.
   </para>
   <procedure xml:id="pro-update-sle12-manual-dvd">
    <title>Manuelle Aufrüstung von SLE 11 SP3 auf SLE 12 SP1 mit einer DVD</title>
    <step>
     <para>
      Legen Sie DVD 1 des SUSE Linux Enterprise 12-SP1-Installationsmediums ein und booten Sie den Computer. Ein <guimenu>Begrüßungsbildschirm</guimenu> wird geöffnet, gefolgt vom Bootbildschirm.
     </para>
    </step>
    <step>
     <para>
      Wählen Sie die Bootmethode zum Starten des Systems vom Medium aus (weitere Informationen unter <xref linkend="sec-i-yast2-method"/>).
     </para>
    </step>
    <step>
     <para>
      Starten Sie das System vom Medium (weitere Informationen unter <xref linkend="sec-i-yast2-startup"/>).
     </para>
    </step>
    <step>
     <para>
      Fahren Sie gemäß <xref linkend="sec-update-sle12-start-upgr-after-boot"/> mit der Installation fort.
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 xml:id="sec-update-sle12-manual-network">
   <title>Aufrüsten von einer Netzwerkinstallationsquelle</title>
   <para>
    Zum Aufrüsten über eine Netzwerkinstallationsquelle müssen die folgenden Anforderungen erfüllt sein:
   </para>
   <variablelist>
    <title>Anforderungen für das Aufrüsten von einer Netzwerkinstallationsquelle</title>
    <varlistentry>
     <term>Netzwerkinstallationsquelle</term>
     <listitem>
      <para>
       Eine Netzwerkinstallationsquelle ist gemäß <xref linkend="cha-deployment-instserver"/> eingerichtet.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Netzwerkverbindung und Netzwerkdienste</term>
     <listitem>
      <para>
       Sowohl der Installationsserver als auch der Zielcomputer besitzen eine funktionsfähige Netzwerkverbindung. Das Netzwerk muss die folgenden Dienste umfassen: Namendienst, DHCP (optional, zum Booten über PXE jedoch erforderlich) und OpenSLP (optional).
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Installationsmedien</term>
     <listitem>
      <para>
       Sie haben eine SUSE Linux Enterprise-DVD 1 (oder ein lokales ISO-Image) zur Hand, mit dem Sie das Zielsystem booten können, <emphasis>oder</emphasis> ein Zielsystem, das gemäß <xref linkend="sec-deployment-prep-boot-pxeprep" xrefstyle="HeadingOnPage"/> für das Booten über PXE eingerichtet ist. Detaillierte Informationen zum Starten der Aufrüstung von einem Remote-Server finden Sie unter <xref linkend="cha-deployment-remoteinst"/>.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    Beim Aufrüsten von einer Netzwerkinstallationsquelle können Sie wahlweise vom lokalen Medium booten und dann den entsprechenden Netzwerkinstallationstyp auswählen oder über PXE booten. Entscheiden Sie sich für eine Methode und fahren Sie gemäß <xref linkend="pro-update-sle12-manual-network-boot-from-dvd" xrefstyle="select:label"/> bzw. <xref linkend="pro-update-sle12-manual-network-pxe-boot" xrefstyle="select:label"/> fort.
   </para>
   <procedure xml:id="pro-update-sle12-manual-network-boot-from-dvd">
    <title>Manuelle Aufrüstung von SLE 11 SP3 oder SP4 auf SLE 12 SP1 mit einer Netzwerkinstallationsquelle – Booten von DVD</title>
    <para>
     In diesem Verfahren wird das Booten von DVD als Beispiel beschrieben. Sie können jedoch auch ein anderes lokales Installationsmedium verwenden, z. B. ein ISO-Image auf einem USB-Massenspeichergerät. Das Verfahren zum Auswählen der Bootmethode und zum Starten des Systems vom Medium hängt von der Systemarchitektur und davon ab, ob der Computer mit einem herkömmlichen BIOS oder mit UEFI ausgestattet ist. Weitere Informationen finden Sie unter den nachfolgenden Links.
    </para>
    <step>
     <para>
      Legen Sie DVD 1 des SUSE Linux Enterprise 12-SP1-Installationsmediums ein und booten Sie den Computer. Ein <guimenu>Begrüßungsbildschirm</guimenu> wird geöffnet, gefolgt vom Bootbildschirm.
     </para>
    </step>
    <step>
     <para>
      Wählen Sie die gewünschte Netzwerkinstallationsquelle aus (FTP, HTTP, NFS, SMB oder SLP). Diese Auswahl erhalten Sie in der Regel mit <keycap>F4</keycap>. Falls der Computer mit UEFI statt mit einem herkömmlichen BIOS ausgestattet ist, müssen Sie ggf. die Bootparameter manuell anpassen. Weitere Informationen finden Sie unter <xref linkend="sec-i-yast2-source-net"/> in <xref linkend="cha-inst"/>.
     </para>
    </step>
    <step>
     <para>
      Fahren Sie gemäß <xref linkend="sec-update-sle12-start-upgr-after-boot"/> mit der Installation fort.
     </para>
    </step>
   </procedure>
   <procedure xml:id="pro-update-sle12-manual-network-pxe-boot">
    <title>Manuelle Aufrüstung von SLE 11 SP3 oder SP4 auf SLE 12 SP1 mit einer Netzwerkinstallationsquelle – Booten über PXE</title>
    <para>
     So führen Sie die Aufrüstung von einer Netzwerkinstallationsquelle mit dem PXE-Boot aus:
    </para>
    <step>
     <para>
      Passen Sie das Setup Ihres DHCP-Servers an, damit die für den PXE-Boot erforderlichen Adressinformationen angegeben werden. Weitere Informationen finden Sie unter <xref linkend="sec-deployment-prep-boot-pxeprep"/>.
     </para>
    </step>
    <step>
     <para>
      Richten Sie einen TFTP-Server ein, auf dem das Boot-Image für das Booten über PXE abgelegt wird. Nutzen Sie hierfür DVD 1 des SUSE Linux Enterprise-Service Packs oder befolgen Sie die Anweisungen in <xref linkend="sec-deployment-prep-boot-tftp"/>.
     </para>
    </step>
    <step>
     <para>
      Bereiten Sie den PXE-Boot und Wake-on-LAN auf dem Zielcomputer vor.
     </para>
    </step>
    <step>
     <para>
      Starten Sie den Boot des Zielsystems und verwenden Sie VNC, um sich entfernt mit der auf diesem Computer ausgeführten Installationsroutine zu verbinden. Weitere Informationen finden Sie unter <xref linkend="sec-deployment-remoteinst-monitor-vnc"/>.
     </para>
    </step>
    <step>
     <para>
      Fahren Sie gemäß <xref linkend="sec-update-sle12-start-upgr-after-boot"/> mit der Installation fort.
     </para>
    </step>
   </procedure>
  </sect2>
 </sect1>
 <sect1 xml:id="sec-update-sle12-automated">
  <title>Automatische Migration von SLE 11 SP3 oder SP4 auf SLE 12 SP1</title>

  <para>
   Vor dem Aufrüsten des Systems beachten Sie <xref linkend="sec-update-prep"/> Gehen Sie folgendermaßen vor, um eine automatische Migration auszuführen:
  </para>

  <procedure xml:id="pro-update-sle12-automated">
   <title>Automatische Migration von SUSE Linux Enterprise 11 SP3 zu SUSE Linux Enterprise 12 SP1</title>
   <remark>toms 2014-03-19: See FATE#315037</remark>
   <remark role="future">toms 2014-03-20: From SLE12 SP1 on, we should probably base
    this example on GRUB2, but not for GA.</remark>
   <remark>jsrain 2015-09-02: This is still the old system; at some point
       of time we should switch to GRUB2, but as long as amjority of
       customers still runs SLE11, I would stay with legacy GRUB. Anyway, we
       could include both op6tions, that would be probably best solution</remark>
   <step>
    <para>
     Kopieren Sie den Installations-Kernel <filename>linux</filename> und die Datei <filename>initrd</filename> von <filename>/boot/x86_64/loader/</filename> auf der ersten Installations-DVD in das <filename>/boot</filename>-Verzeichnis des Systems:
    </para>
<screen><command>cp</command> -vi <replaceable>DVDROOT</replaceable>/boot/x86_64/loader/linux /boot/linux.upgrade
<command>cp</command> -vi <replaceable>DVDROOT</replaceable>/boot/x86_64/loader/initrd /boot/initrd.upgrade</screen>
    <para>
     <replaceable>DVDROOT</replaceable> bezeichnet den Pfad, in den das System die DVD einhängt, normalerweise <filename>/run/media/$USER/$DVDNAME</filename>.
    </para>
   </step>
   <step>
    <para>
     Öffnen Sie die alte GRUB-Konfigurationsdatei <filename>/boot/grub/menu.lst</filename> und fügen Sie einen weiteren Abschnitt hinzu. Bearbeiten Sie für andere Bootloader die entsprechenden Konfigurationsdateien. Passen Sie die Gerätenamen und den Parameter <parameter>Root</parameter> entsprechend an. Beispiel:
    </para>
<screen>title Linux Upgrade Kernel
kernel (hd0,0)/boot/linux.upgrade root=/dev/sda1 upgrade=1 <replaceable>OPTIONAL_PARAMETERS</replaceable>
initrd (hd0,0)/boot/initrd.upgrade</screen>
    <para>
     <replaceable>OPTIONAL_PARAMETERS</replaceable> bezeichnen zusätzliche Boot-Parameter, die Sie möglicherweise zum Booten Ihres Systems und zum Durchführen der Aufrüstung benötigen. Unter Umständen sind dies Kernel-Parameter, die für das System erforderlich sind. Überprüfen Sie diese Parameter daher und kopieren Sie sie ggf. aus einem vorhandenen GRUB-Eintrag. Alternativ sind hier SUSE <link xlink:href="http://en.opensuse.org/Linuxrc">linuxrc-Parameter aufgeführt, die online dokumentiert sind</link>.
    </para>
   </step>
   <step>
    <para>

     Wenn die Aufrüstung automatisch durchgeführt werden soll, fügen Sie <option>autoupgrade=1</option> am Ende der <literal>kernel</literal>-Zeile in der GRUB-Konfiguration an.
    </para>
   </step>
   <step>
    <para>
     Booten Sie Ihren Rechner neu und wählen Sie den neu hinzugefügten Abschnitt im Boot-Menü aus (hier: <emphasis>Linux-Aufrüstungs-Kernel</emphasis>). Mit <command>grubonce</command> können Sie den neu erstellten GRUB-Eintrag für einen unbeaufsichtigten automatischen Neustart in den neu erstellten Eintrag vorab auswählen. Sie können auch <command>reboot</command> verwenden, um den Reboot von der Kommandozeile aus zu initiieren.
    </para>
   </step>
   <step>
    <para>
     Fahren Sie gemäß <xref linkend="sec-update-sle12-start-upgr-after-boot"/> mit dem gewohnten Aufrüstungsvorgang fort.
    </para>
   </step>
   <step>
    <para>
     Nach Fertigstellung des Aufrüstungsvorgangs entfernen Sie den Installations-Kernel und die initrd-Dateien (<filename>/boot/linux.upgrade</filename> und <filename>/boot/initrd.upgrade</filename>). Sie werden nicht mehr benötigt.
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 xml:id="sec-update-sle12-start-upgr-after-boot">
  <title>Starten des Aufrüstungsvorgangs nach dem Booten</title>

  <para>
   <remark>taroth 2014-11-13: argh, the following is terminology hell regarding
     the software strings: "upgrade"/"update" are used intermittently and
     without clear differentiation...</remark>
  </para>

  <procedure>
   <step>
    <para>
     Nach dem Booten (von einem Installationsmedium oder über das Netzwerk) wählen Sie im Bootbildschirm die Option <guimenu>Aufrüsten</guimenu>.
    </para>
    <warning>
     <title>Möglicher Datenverlust durch falsche Auswahl</title>
     <para>
      Wenn Sie <guimenu>Installation</guimenu> statt <guimenu>Aufrüsten</guimenu> wählen, können später Daten verlorengehen. Durch eine versehentliche Neuinstallation können die vorhandenen Datenpartitionen unter Umständen zerstört werden, z. B. durch Neupartitionieren der Festplatten (zerstört die vorhandenen Partitionen) oder durch Neuformatieren der Datenpartitionen (löscht alle vorhandenen Daten).
     </para>
     <para>
      Wählen Sie hier in jedem Fall die Option <guimenu>Aufrüsten</guimenu>.
     </para>
    </warning>
    <para>
     YaST startet das Installationssystem.
    </para>
   </step>
   <step>
    <para>
     Wählen Sie im Bildschirm <guimenu>Willkommen</guimenu> die <guimenu>Sprache</guimenu> und die Belegung der <guimenu>Tastatur</guimenu> aus und nehmen Sie die Lizenzvereinbarung an. Fahren Sie mit <guimenu>Weiter</guimenu> fort.
    </para>
    <para>
     YaST sucht auf den Partitionen nach bereits installierten SUSE Linux Enterprise-Systemen.
    </para>
   </step>
   <step>
    <para>
     Wählen Sie im Bildschirm <guimenu>Zum Aufrüsten auswählen</guimenu> die aufzurüstende Partition aus und klicken Sie auf <guimenu>Weiter</guimenu>.
    </para>
    <para>
     YaST hängt die ausgewählte Partition ein und zeigt alle Repositorys an, die sich in der aufzurüstenden Partition befinden.
    </para>
   </step>
   <step>
    <para>
     Passen Sie im Bildschirm <guimenu>Zuvor verwendete Repositorys</guimenu> den Status der Repositorys an: Aktivieren Sie die Repositorys, die beim Aufrüstungsprozess berücksichtigt werden sollen, und deaktivieren Sie alle nicht mehr benötigten Repositorys. Fahren Sie mit <guimenu>Weiter</guimenu> fort.
    </para>
   </step>
   <step>
    <para>
     Geben Sie im Bildschirm <guimenu>Registrierung</guimenu> an, dass das aufgerüstete System jetzt registriert werden soll (geben Sie hierzu Ihre Registrierungsdaten ein und klicken Sie auf <guimenu>Weiter</guimenu>) oder wählen Sie <guimenu>Registrierung überspringen</guimenu>. Weitere Informationen zum Registrieren des Systems finden Sie in <xref linkend="sec-update-registersystem"/>.
    </para>
   </step>
   <step>
    <para>
     Prüfen Sie die <guimenu>Installationseinstellungen</guimenu> für die Aufrüstung, insbesondere die <guimenu>Optionen für das Update</guimenu>. Folgende Optionen stehen zur Auswahl:
    </para>
    <itemizedlist>
     <listitem>
      <para>
       <guimenu>Nur installierte Pakete aktualisieren</guimenu>. Hierbei entgehen Ihnen allerdings ggf. neue Funktionen aus der aktuellen SUSE Linux Enterprise-Version.
      </para>
     </listitem>
     <listitem>
      <para>
       <guimenu>Update mit Installation neuer Software und neuer Funktionen</guimenu>. Mit <guimenu>Schemata auswählen</guimenu> können Sie die Schemata und Pakete je nach Bedarf aktivieren oder deaktivieren.
      </para>
     </listitem>
    </itemizedlist>

    <note>
     <title>Auswahl des Desktops</title>
     <para>
      Wenn Sie vor dem Aufrüsten auf SUSE Linux Enterprise 12 mit KDE gearbeitet haben (<varname>DEFAULT_WM</varname> in <filename>/etc/sysconfig/windowmanager</filename> war auf <literal>kde*</literal> eingestellt), wird die bisherige Desktop-Umgebung nach der Aufrüstung automatisch durch GNOME ersetzt. Standardmäßig wird der KDM-Anzeigemanager durch GDM ersetzt.
     </para>
     <para>
      Soll eine andere Desktop-Umgebung oder ein anderer Fenstermanager ausgewählt werden, klicken Sie auf <guimenu>Schemata auswählen</guimenu> und wählen Sie die gewünschte Option.
     </para>
    </note>
   </step>
   <step>
    <para>
     Wenn die Einstellungen Ihren Anforderungen entsprechen, starten Sie den Installations- und Löschvorgang mit <guimenu>Aktualisieren</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Prüfen Sie nach dem erfolgreichen Abschluss des Upgradevorgangs, ob <quote>verwaiste Pakete</quote> vorhanden sind. Bei verwaisten Paketen handelt es sich um Pakete, die keinem aktiven Repository mehr angehören. Mit dem folgenden Kommando erhalten Sie eine entsprechende Liste:
    </para>
<screen>zypper packages --orphaned</screen>
    <para>
     Mithilfe dieser Liste können Sie entscheiden, ob ein Paket nach wie vor benötigt wird oder gefahrlos deinstalliert werden kann.
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 xml:id="sec-update-sle12-manager">
  <title>Aktualisieren über SUSE Manager</title>

  <para>
   SUSE Manager ist eine Serverlösung für die Bereitstellung von Aktualisierungen, Patches und Sicherheitsreparaturen für SUSE Linux Enterprise-Clients. Hier finden Sie eine Reihe von Werkzeugen und eine webgestützte Bedienoberfläche für Verwaltungsaufgaben. Weitere Informationen finden Sie im <link xlink:href="https://www.suse.com/products/suse-manager/"/>.
  </para>
 </sect1>
 <sect1 xml:id="sec-update-reg-status-after-rollback">
  <title>Aktualisieren des Registrierungsstatus nach einem Rollback</title>

  <para>
   Bei einer Service Pack-Migration muss die Konfiguration auf dem Registrierungsserver geändert werden, um den Zugriff auf die neuen Repositorys zu ermöglichen. Wenn ein Migrationsvorgang unterbrochen oder (durch Wiederherstellung auf Basis einer Sicherung oder eines Snapshots) rückgängig gemacht wird, sind die Informationen auf dem Registrierungsserver nicht mehr mit dem Status des Systems konsistent. Dies kann dazu führen, dass Sie nicht auf die Aktualisierungs-Repositorys zugreifen können oder die falschen Repositorys auf dem Client verwendet werden.
  </para>

  <para>
   Wenn über Snapper ein Rollback erfolgt, benachrichtigt das System den Registrierungsserver, um sicherzustellen, dass während des Bootvorgangs der Zugriff auf die richtigen Repositorys eingerichtet wird. Wenn das System auf andere Weise wiederhergestellt wurde oder aus irgendeinem Grund ein Fehler bei der Kommunikation mit dem Registrierungsserver auftrat (weil beispielsweise aufgrund von Netzwerkproblemen kein Zugriff auf den Server möglich war), lösen Sie das Rollback auf dem Client manuell aus, indem Sie Folgendes aufrufen:
  </para>

<screen><command>snapper</command> rollback</screen>

  <para>
   Es wird empfohlen, grundsätzlich zu prüfen, ob die richtigen Repositorys auf dem System eingerichtet wurden. Dies gilt insbesondere nach der Aktualisierung des Service mit
  </para>

<screen><command>zypper</command> ref -s</screen>

  <para>
   Diese Funktionalität ist im
   <package>rollback-helper-</package>
   Paket verfügbar.
  </para>
 </sect1>
 <sect1 xml:id="sec-update-registersystem">


  <title>Registrieren des Systems</title>

  <para>
   Falls Sie die Registrierung während der Installation übersprungen hatten, können Sie das System jederzeit nachträglich mit dem YaST-Modul <guimenu>Produktregistrierung</guimenu> nachholen.
  </para>

  <para>
   Die Registrierung der Systeme bietet die folgenden Vorteile:
  </para>

  <itemizedlist>
   <listitem>
    <para>
     Zugang zum Support
    </para>
   </listitem>
   <listitem>
    <para>
     Zugang zu Sicherheitsupdates und Fehlerbehebungen
    </para>
   </listitem>
   <listitem>
    <para>
     Zugang zum SUSE Customer Center
    </para>
   </listitem>
  </itemizedlist>

  <procedure>
   <step>
    <para>
     Starten Sie YaST und wählen Sie <menuchoice> <guimenu>Software</guimenu> <guimenu>Produktregistrierung</guimenu> </menuchoice>. Das Dialogfeld <guimenu>Registrierung</guimenu> wird geöffnet.
    </para>
   </step>
   <step>
    <para>
     Geben Sie die <guimenu>E-Mail</guimenu>-Adresse für das SUSE-Konto ein, mit dem Sie oder Ihr Unternehmen die Abonnements verwalten. Falls Sie noch kein SUSE-Konto besitzen, wechseln Sie zur SUSE Customer Center-Startseite (<link xlink:show="new" xlink:href="https://scc.suse.com/"/>), und erstellen Sie dort ein Konto.
    </para>
   </step>
   <step>
    <para>
     Geben Sie den <guimenu>Registrierungscode</guimenu> ein, den Sie zusammen mit Ihrem Exemplar von <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> erhalten haben.
    </para>
   </step>
   <step xml:id="step-y2-register-final">
    <para>
     Starten Sie die Registrierung mit <guimenu>Weiter</guimenu>. Wenn ein oder mehrere lokale Registrierungsserver in Ihrem Netzwerk verfügbar sind, können Sie einen Server aus einer Liste auswählen. Alternativ klicken Sie auf <guimenu>Abbrechen</guimenu>; damit ignorieren Sie die lokalen Registrierungsserver, und die Registrierung erfolgt beim standardmäßigen SUSE-Registrierungsserver.
    </para>
    <para>
     Während der Registrierung werden die Online-Aktualisierungs-Repositorys zu Ihrer Upgrade-Einrichtung hinzugefügt. Abschließend können Sie angeben, ob die verfügbaren aktuellen Paketversionen über die Aktualisierungs-Repositorys installiert werden sollen. Damit erhalten Sie einen korrekten Upgradepfad für sämtliche Pakete und es ist sichergestellt, dass <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> stets mit den neuesten verfügbaren Sicherheitsaktualisierungen aufgerüstet wird. Mit <guimenu>Nein</guimenu> werden alle Pakete von den Installationsmedien installiert. Fahren Sie mit <guimenu>Weiter</guimenu> fort.
    </para>
    <para>
     Nach erfolgter Registrierung zeigt YaST eine Liste der verfügbaren Erweiterungen, Add-ons und Module für Ihr System an. Zum Auswählen und Installieren eines Elements fahren Sie mit <xref linkend="sec-add-ons-extensions"/> fort.
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 xml:id="sec-update-sle12-multiversion">
  <title>Beibehalten der Kernel-Pakete</title>

  <remark>toms 2015-08-26: bsc#753809</remark> <remark>toms 2015-08-26: some parts are taken ("stolen") from the
      wiki at https://en.opensuse.org/SDB:Keep_multiple_kernel_versions
      and adapted
    </remark> <indexterm> <primary>Multiversions-Kernel</primary> </indexterm>

  <para>
   Wenn Sie einen neuen Kernel mit YaST oder Zypper installieren, behält SUSE Linux Enterprise die letzten beiden Kernel zusätzlich zum ausgeführten Kernel bei. Für gewöhnlich reicht dies aus.
  </para>

  <para>
   In bestimmten Situationen sollen allerdings mehr Kernel-Versionen beibehalten werden, beispielsweise zu Testzwecken. SUSE Linux Enterprise unterstützt hierzu die <emphasis>Funktion für Multiversions-Kernel</emphasis>. Mit dieser Funktion können Sie das Standardverhalten wie folgt ändern und konfigurieren:
  </para>

  <itemizedlist>
   <listitem>
    <para>
     Ein alter Kernel wird erst dann gelöscht, wenn das System fehlerfrei mit dem neuen Kernel neu gestartet wurde.
    </para>
   </listitem>
   <listitem>
    <para>
     Eine definierte Anzahl an älteren Kernels wird als Fallback beibehalten.
    </para>
   </listitem>
   <listitem>
    <para>
     Eine bestimmte Kernel-Version wird beibehalten.
    </para>
   </listitem>
  </itemizedlist>

  <para>
   Nach dem erfolgreichen Neustart wird die Liste der installierten Kernel mit den Einstellungen in der Datei <filename>/etc/zypp/zypp.conf</filename> mithilfe eines Skripts verglichen und die nicht mehr benötigten Kernel werden gelöscht.
  </para>

  <sect2 xml:id="sec-update-sle12-multiversion-enable">
   <title>Aktivieren der Funktion für Multiversions-Kernel</title>
   <para>
    Das Standardverhalten ist in der Konfigurationsdatei <filename>/etc/zypp/zypp.conf</filename> definiert:
   </para>
<screen><prompt>root # </prompt><command>grep</command> ^multiversion /etc/zypp/zypp.conf
multiversion = provides:multiversion(kernel)
multiversion.kernels = latest,latest-1,running</screen>
   <para>
    Zum Aktivieren dieser Funktion entfernen Sie alle Rauten (#) vor der obigen Zeile <literal>multiversion</literal> (dies sollte bereits der Fall sein). In der zweiten Zeile legen Sie fest, <emphasis>welche</emphasis> Kernel beibehalten werden sollen. Sie müssen beide Zeilen aktivieren; ansonsten behält das System <emphasis>alle</emphasis> Kernel bei, sodass unnötig Speicherplatz auf der Festplatte belegt wird.
   </para>
   <para>
    Die Zeile <literal>multiversion.kernels</literal> kann mehrere Schlüsselwörter in verschiedenen Kombinationen und unterschiedlicher Reihenfolge aufnehmen:
   </para>
   <variablelist>
    <varlistentry>
     <term><option>latest</option>
     </term>
     <listitem>
      <para>
       Kernel mit höchster Versionsnummer beibehalten
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><option>latest-<replaceable>N</replaceable></option>
     </term>
     <listitem>
      <para>
       Kernel mit <replaceable>n</replaceable>-höchster Versionsnummer beibehalten; <replaceable>n</replaceable> ist eine Zahl größer oder gleich 1
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><option>running</option>
     </term>
     <listitem>
      <para>
       Ausgeführten Kernel beibehalten
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><option>oldest</option>
     </term>
     <listitem>
      <para>
       Kernel mit der niedrigsten Versionsnummer beibehalten (Kernel im herausgegebenen Produkt)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><option>oldest-<replaceable>N</replaceable></option>
     </term>
     <listitem>
      <para>
       Kernel mit <replaceable>N</replaceable>-niedrigster Versionsnummer beibehalten
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><option>3.12.28-4.6</option>
     </term>
     <listitem>
      <para>
       Genau diese Kernel-Version beibehalten
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2 xml:id="sec-update-sle12-multiversion-deleteoldkernel">
   <title>Anwendungsfall: Löschen eines alten Kernels erst nach dem Neustart</title>
   <para>
    Ein alter Kernel soll erst dann gelöscht werden, wenn das System fehlerfrei mit dem neuen Kernel gebootet wurde.
   </para>
   <para>
    Ändern Sie die folgende Zeile in <filename>/etc/zypp/zypp.conf</filename>:
   </para>
<screen>multiversion.kernels = latest,running</screen>
   <para>
    Die Parameter weisen das System an, den aktuellen Kernel und den ausgeführten Kernel nur dann beizubehalten, wenn sie nicht identisch sind.
   </para>
  </sect2>

  <sect2 xml:id="sec-update-sle12-multiversion-fallback">
   <title>Anwendungsfall: Beibehalten älterer Kernel als Fallback</title>
   <para>
    Mindestens eine Kernel-Version soll als <quote>Ersatz</quote>-Kernel beibehalten werden.
   </para>
   <para>
    Dieser Anwendungsfall greift, wenn Sie mehrere Kernel zu Testzwecken beibehalten möchten. Sollte ein Problem eintreten, beispielsweise weil der Computer nicht bootet, können Sie dennoch auf mindestens eine bekanntermaßen funktionsfähige Kernel-Version zurückgreifen.
   </para>
   <para>
    Ändern Sie die folgende Zeile in <filename>/etc/zypp/zypp.conf</filename>:
   </para>
<screen>multiversion.kernels = latest,latest-1,latest-2,running</screen>
   <para>
    Wenn Sie das System nach der Installation eines neuen Kernels neu booten, behält das System drei Kernel bei: den neuen, ausgeführten Kernel (als <literal>latest,running</literal> konfiguriert), die vorherige Kernel-Version des neuen Kernels (als <literal>latest-1</literal> konfiguriert) sowie den Vorgänger der vorherigen Kernel-Version (als <literal>latest-2</literal> konfiguriert).
   </para>
  </sect2>

  <sect2 xml:id="sec-update-sle12-multiversion-specificversion">
   <title>Anwendungsfall: Beibehalten einer bestimmten Kernel-Version</title>
   <para>
    Sie nehmen regelmäßige Systemaktualisierungen vor und installieren neue Kernel-Versionen. Daneben kompilieren Sie eine eigene Kernel-Version zu verschiedenen Zwecken, die im System beibehalten werden soll.
   </para>
   <para>
    Ändern Sie die folgende Zeile in <filename>/etc/zypp/zypp.conf</filename>:
   </para>
<screen>multiversion.kernels = latest,3.12.28-4.20,running</screen>
   <para>
    Wenn Sie das System nach der Installation eines neuen Kernels neu booten, behält das System zwei Kernel bei: den neuen, ausgeführten Kernel (als <literal>latest,running</literal> konfiguriert) und den selbst kompilierten Kernel (als <literal>latest-3.12.28,4.20</literal> konfiguriert).
   </para>
  </sect2>
 </sect1>
</chapter>
