<?xml version="1.0" encoding="UTF-8"?>
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="sle_update_migration.xml" version="5.0" xml:id="cha.update.spmigration">
  <title>Migrazione del Service Pack</title>
  <info>
    <abstract>
      <para>SUSE offre ora agli amministratori di sistema nuovi strumenti con alcune funzioni interessanti per la migrazione del Service Pack online. Si tratta di semplici strumenti da riga di comando, un&apos;interfaccia grafica utente intuitiva, il supporto per il <quote>rollback</quote> dei Service Pack e altri strumenti. In questo capitolo viene illustrato nei dettagli come eseguire la migrazione di un Service Pack con i nuovi strumenti.</para>
    </abstract>
  </info>

  <sect1 xml:id="sec.update.migr.supported-scenarios-and-versions">
    <title>Versioni e scenari supportati</title>
    <para>SUSE supporta i seguenti scenari, offline o online:</para>

    <variablelist>
      <varlistentry>
        <term>Online</term>
        <listitem>
          <para>SUSE Customer Center, Subscription Management Tool (SMT), SUSE Manager</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Offline</term>
        <listitem>
          <para>DVD di avvio, chiavetta USB, immagine ISO, AutoYaST, <quote>rpm semplice</quote> e strumenti di terze parti</para>
        </listitem>
      </varlistentry>
    </variablelist>
    
    <para>Sono supportate le seguenti versioni:</para>
    
    <variablelist>
      <varlistentry>
        <term>Online</term>
        <listitem>
          <para>SUSE Linux Enterprise 12</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Offline</term>
        <listitem>
          <para>SUSE Linux Enterprise 11 SP3/SP4, SUSE Linux Enterprise 12</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Manualmente/terze parti</term>
        <listitem>
          <para>SUSE Linux Enterprise 12</para>
        </listitem>
      </varlistentry>
    </variablelist>
  </sect1>

  <sect1 xml:id="sec.update.migr.workflow">
    <title>Workflow di migrazione del Service Pack</title>
    <para>È possibile eseguire la migrazione del Service Pack da YaST, <command>zypper</command>, AutoYaST, RPM o da strumenti di terze parti. In questo capitolo sono descritte solo le prime due procedure. Indipendentemente dal metodo, una migrazione del Service Pack consiste nei seguenti passaggi:</para>
    <orderedlist>
      <listitem>
        <para>Trovare possibili destinazioni della migrazione.</para>
      </listitem>
      <listitem>
        <para>Selezionare una destinazione della migrazione.</para>
      </listitem>
      <listitem>
        <para>Richiedere e abilitare nuovi archivi.</para>
      </listitem>
      <listitem>
        <para>Eseguire la migrazione.</para>
      </listitem>
    </orderedlist>

    
    <para>L&apos;elenco di destinazioni di migrazione dipende dai prodotti installati. Se è installata un&apos;estensione per cui non è ancora disponibile il nuovo Service Pack, è possibile che non venga resa disponibile alcuna destinazione.</para>
    <para>L&apos;elenco delle destinazioni di migrazione disponibili per l&apos;host viene sempre recuperato da SUSE Customer Center, dipende dalle estensioni o dai prodotti installati e potrebbe cambiare nel tempo. Ciò significa che, ad esempio, la migrazione da SLE12 GA a SP2 potrebbe essere possibile per un host, ma non per un altro.</para>
  </sect1>

  <sect1 xml:id="sec.update.migr.yast.onlinemigr">
    <title>Migrazione con YaST (strumento di migrazione online)</title>
    <para>Per eseguire una migrazione del Service Pack con YaST, utilizzare lo strumento <guimenu>Migrazione online</guimenu>. Per default, YaST non installa i pacchetti da un archivio di terze parti. Se un pacchetto è stato installato da un archivio di terze parti, YaST impedisce che il pacchetto venga sostituito con lo stesso pacchetto proveniente da SUSE.
    </para>
    <procedure xml:id="pro.update.migr.yast">
      <step>
        <para>Installare gli ultimi aggiornamenti per ottenere il modulo <guimenu>Migrazione online</guimenu>.</para>
      </step>
      <step>
        <para>Installare il pacchetto <package>yast2-migration</package>
          e le relative dipendenze. </para>
      </step>
      <step>
        <para>Riavviare YaST. In caso contrario il modulo appena installato non verrà mostrato nel centro di controllo.</para>
      </step>
      <step>
        <para>Avviare il modulo <guimenu>Migrazione online</guimenu> dalla sezione <guimenu>Sistema</guimenu> in YaST. </para>
        <para>YaST mostrerà le destinazioni di migrazione possibili e un riepilogo.</para>
      </step>
      <step>
        <para>Selezionare una destinazione di migrazione e continuare con <guimenu>Avanti</guimenu>.</para>
      </step>
      <step>
        <para>Se lo strumento di migrazione online offre archivi aggiornati, decidere se si desidera utilizzarli. È consigliabile continuare scegliendo <guimenu>Sì</guimenu>.
          
        </para>
      </step>
      <step>
        <para><remark>toms 2015-09-09: FATE#319140</remark> Se lo strumento di migrazione online rileva archivi obsoleti provenienti da DVD o da un server locale, è consigliabile disabilitarli. Gli archivi precedenti di SUSE Customer Center o Subscription Management Tool vengono rimossi automaticamente.
        </para>
      </step>
      <step>
        <para>Controllare il riepilogo e continuare con la migrazione facendo clic su <guimenu>Avanti</guimenu>. Confermare con <guimenu>Avvia aggiornamento</guimenu>.</para>
      </step>
      <step>
        <para>Al termine della migrazione, riavviare il sistema.</para>
      </step>
    </procedure>
  </sect1>

  <sect1 xml:id="sec.update.migr.zypper.onlinemigr">
    <title>Migrazione con Zypper</title>
    <para>Per eseguire una migrazione del Service Pack con Zypper, utilizzare lo strumento da riga di comando <command>zypper</command> <option>migration</option>.</para>
    <procedure>
      <step>
        <para>Eseguire il login al computer con SUSE Linux Enterprise 12.</para>
      </step>
      <step>
        <para>Installare gli ultimi aggiornamenti.</para>
      </step>
      <step>
        <para>Installare i pacchetti
            <package>zypper-migration-plugin</package> e le relative dipendenze. </para>
      </step>
      <step>
        <para>Eseguire il comando <command>zypper</command> <option>migration</option>:</para>
        <screen><prompt>root # </prompt><command>zypper</command> migration
Executing 'zypper  patch-check'

Refreshing service 'SUSE_Linux_Enterprise_Server_12_x86_64'.
Loading repository data...
Reading installed packages...
0 patches needed (0 security patches)

Available migrations:

    1 | SUSE Linux Enterprise Server 12 SP1 x86_64</screen>
        <remark>toms 2015-09-07: From FATE#319128</remark>
        <para>Per default, Zypper usa l&apos;opzione <option>--no-allow-vendor-change</option>, che viene passata a <command>zypper</command> <option>dup</option>. Se un pacchetto è stato installato da un archivio di terze parti, questa opzione impedisce che il pacchetto venga sostituito con lo stesso pacchetto proveniente da SUSE.
        </para>
      </step>
      <step>
        <para>
        <remark>toms 2015-09-09: FATE#319140</remark> Se Zypper rileva archivi obsoleti provenienti da DVD o da un server locale, è consigliabile disabilitarli. Gli archivi SCC o SMT precedenti vengono rimossi automaticamente.
        </para>
      </step>
      <step>
        <para>Rivedere tutte le modifiche, soprattutto i pacchetti che verranno rimossi. Procedere digitando <literal>y</literal> (il numero esatto di pacchetti di cui eseguire l&apos;upgrade può variare in base al sistema):</para>
        <screen>266 packages to upgrade, 54 to downgrade, 17 new, 8 to reinstall, 5 to remove, 1 to change arch.
Overall download size: 285.1 MiB. Already cached: 0 B  After the operation, additional 139.8 MiB will be used.
Continue? [y/n/? shows all options] (y):</screen>
        <para>Utilizzare i tasti <keycombo> <keycap function="shift"/> <keycap function="pageup"/> </keycombo> o <keycombo> <keycap function="shift"/> <keycap function="pagedown"/> </keycombo> per scorrere nella shell.</para>
      </step>
      <step>
        <para>Al termine della migrazione, riavviare il sistema.</para>
      </step>
    </procedure>
  </sect1>

</chapter>
